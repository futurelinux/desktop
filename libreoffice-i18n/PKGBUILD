pkgbase="libreoffice-i18n"

_rcver=6.4.0.3
pkgver=6.4.0
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('fcae0b8a0bb85ffb497788b6079d7757'
         'acd85755bd789923631f653b0e163ec0'
         'b4e8bd7f1946c9f24a6c0d1a7b8f8911'
         '3ac67909948a77a53979b93f1a82a650'
         '36b4edd26c088896b4043bd4859e3222'
         '3c875c004d31ece5dd94b5a1006e5abc'
         'aadbf00cc5e1e8759da087c499177385'
         'a0099c259ade7331ac31c4321ca32ed4'
         '145b3e4e75d52bfb79ed8d610f680fac'
         '733efeaf658b0e87f6084bb7b48fc74c'
         'b2480fd2138954e9db7fc2f11577e855'
         '0c38d4884e86aae0fb98712c9b124b8c'
         '8ed1e0ee83d257b453249dd714e978b1'
         '5b45813a23aa95e2fe8bc84593fb5cfd'
         '9779930189856b6c1f4a06bf76625cce'
         '093af653ad35432386161d3e91769372'
         'ac1283653b6b3e15eeff65386049239c'
         '084415bbd31c4ee03a7a95d085dfe6b8'
         '785b0c8fd0171c686a0c917cb5a8b99e'
         '3f9c1abdb765456847e575eec37ab288'
         '6ef0d1a8ec6eb45879521b58a269c4ea'
         'e7a5e89331e208be4f93e27aa0642ee5'
         'fb171a44ab32110969d8d1e49040fff2'
         'd76a9c5e1d6d462ba79d07bac76a67aa'
         '3a27458141391a398018f53248b25bce'
         '8349e6f19d86c102f469de8f7fa8afa1'
         '87e85866534d3541f72c5db9c558b04a'
         '6276a84c9ef2a3a9e0ae457ac7f2ab18'
         '2f20d7c8098237550a616ac50c6bf3ed'
         '149858a6235b7def79441ae2a9229c73'
         'd05d62e099ac6227dd04baf869de94f2'
         '4b61a6fa742cf5e33e642a0b88543f56'
         '38c8edf66c02eac98d3fbafa8192d660'
         'df119cef08643143dfa12b76bdd1475b'
         '311b836f71fe9f40a655f9625b798fca'
         'cf207623006e970fe9af9a2b10e15801'
         'f12fe00db1b6f55a7ffa197159cbebf9'
         'f7def20f1612bea1669bce1aeef4db15'
         '19b1149d506165fd2a747b18cdf5adf3'
         '0713a218c98369c934887211b3408fc8'
         'dff2df6bb4add789f1634faa784dfb99'
         '915abac0fdae38b03bff8966daff09f5'
         'b7eb0ab2e8dc36ca92b29eda294dea3d'
         'b8d3fc591d99e1f2420f283b8b011f9a'
         'ef777b1247f9af58110afba4e13c69fd'
         '4dd0966d9d0d9ded7bb1fae4708cb492'
         'bae59405569dec98b03b83fc6403f518'
         '2aec6d82244b263be2c1ef28210c088d'
         '216cdd8f7e479f9138f823f04c519e15'
         '8609eab3890f4b4c9c00c22cb6872f50'
         '60c4918b827ba8c36ba62b7d90d53427'
         'bc4c2548372ddcd883e9b5829e2f90d2'
         '0207be45d97a8e5c968fdd97da25492c'
         '1927ca9d4f7522fc7c900ae699599fe4'
         '2d899159ad86c3451206046d1e824257'
         'fc1fc4f33f03d9f61f9062352208786b'
         '2362a61113c1bc59fa289107ecf7e1e1'
         'ec22234972c4d4f2a293c224e166c0aa'
         '4433cd5394491c4ae9168429df22a548'
         'c18d6641024ccf2eaf30c355fd896e7d'
         '3b4d2a3a5958c50ac2a2d64a773a6bad'
         'af7b2c1d283bdfa25b2b5f342ebd1176'
         '16e80bd500ef85c7a5b05b9ca5ae7550'
         '0c16fbe832b92e887ed8b0866949aabd'
         'b14e4a828a982743a9e5e2ad0c1181aa'
         'af6c7b1c285588983d0fc3db42303082'
         '53bbabea8a8219016990c8c12dfcebed'
         '38489fdcc570099f6995f3b04eb04c08'
         'f7f3d3044a69cd0018d6b237efabfdce'
         'b4150fdd175aeaebe93a4824dab510a2'
         '27493a870391468ee6ad6cdfe755cd6b'
         'f04c53fb9cecb0c8838dcb4732eb47a3'
         '0ad861668a6f4e66273085f7c92fc0d8'
         'd4037912df040f47cccbc7d83e4ee859'
         'dd9ac792d065caf9c9dfa25e23ae4ad8'
         'f33908ab1928bde6a730fad0a819e2b5'
         '42f86c01798d509067223be8a551d947'
         '7d0ebe930dc6ef1e1c8dabc28d49c32a'
         '371e939757744f309a8fbdaeea182f47'
         '9bb657e204f19af7e4ac0af8548363e8'
         'ab26b0bb0ff3090ce9b901aedfb14f3c'
         'a02e245e66bed7bf31bbac8b18fc5f85'
         'd06e1bfb7eeb703de938473297c39291'
         'db2d674851f905f1d7291195fba50bac'
         'cb4f1d64244a25bee1a8e98fa0655229'
         '10a2f626ba843a1a2264558e4964d520'
         '6639222496d8c1665635b2e420fb37b3'
         '05ada608d6d0f560127c5e06591b2066'
         '273bcbb3540f6d1197232a625fa0ad1c'
         '9c556968fa5a86dd7bf6aa409669d994'
         'aaa48d88bafe2788213c0a01240f77b3'
         '4efb2c53d601558f2fde22cbbf2fa1dd'
         'd655dfc0264b1fd5e3e85d11084e325f'
         'e43ebe3ddf265db898b25c4e7d6823f9'
         '9ae3503e480851a8355723360b2eca96'
         '8a252060cff600a3c2d450565101daa9'
         '88589750ea0f7cd95bfa2ddaa0d2675d'
         'dc3eb0b19e606dcca842668381e44848'
         '53b0ff0111258f7e5c87e5ac453add03'
         '51464e6d9da066ee7ca664e320112ea3'
         'e99f3732ad217aa60aa5d92e0ab967a1'
         'e973f0b24ec0d6cee872fc39995c5ed0'
         'c44de5a73ab05e95c4f7b9de11f4678e'
         'ed1d08e135403d189c0252ede4a8cd87'
         '5c9e69fdee275a9ff27d95b6116e137a'
         'c7432d09374627c6bef6a423db51813a'
         '783dc9a47c1e8a5a004b2a44d1d794a9'
         'd2ee805109a36e3e432f9f8e759f7915'
         '1e7faf30d7505dcd0e33fbcb8683dd93'
         '6793de5bf71502536c7fe2fecb5c281b'
         '119fe41adf55a9c7ff56390b0c7a0632'
         '692d6227938c0a76d19dddc21878a155'
         '6741f2a9954ea90939792cbe0840b37d'
         '630f09349ac0a8731d04cf4bdd95b305'
         '0393b5944ead1e241fbb13d2054ae7ba'
         '18885f19ee56ad9ed5a455cd1b29eb04'
         'ce9b6d386773d52f7e6553a1227dbca2'
         '92673f77379538938eb8015ddec6f255'
         '9ccf9c207dcc06421ab3342d1b60beed'
         '600c08eaab87bbbdbcb1dadaaa57ff85'
         '78fabfa413304db96f063798307d5b18'
         'f598f1378a7aeb12a19a88b12b69a44a'
         'f9b2a7201e706d01fb932fabacd88335'
         '62d74da95ffbc6f606f10dfe7612d434'
         '34658d6e52997714911d33a5e2c39c4b'
         '14aef83b0db38cb8a032bffd26f263a4'
         'e057c2e3d97472c6b244b790a47fab89'
         '374839ff5c34cccb85e99ed9ea4a7003'
         '6341cce763b51489f35b78bf178c5b7a'
         '2776484158789243d4e594aea82fc299'
         '0a0833c6ee16dd6bdde5aa2af72018ff'
         '5fb89e366c87d976a6e5acd8409334b2'
         'd1d7ec8a71dde84f7c54a8fc7b8b772e'
         '0627b14c7b20ae073b348ea221e03014'
         'ed9a217a11502513575686228f22ce90'
         'd745333133b80e0dfff86a270d92b89f'
         'dd8666d5161df84325ba61b26ff6fe63'
         '3716092fbd66b9ef1433f97dc0c83046'
         '96544429aeeb21bb08c4d6c2416910dd'
         'c91205e4a2662766cc9c0fb89c173320'
         '57d380e092b27b777541cb5e395bba2a'
         '09fba663065a4463452eea19744afdc5'
         'cd1ae661a96b198303db81449762dde6'
         'a95cda365961518f79482e0228a1195d'
         'dc609ce9ba4c78174657d63298f2ad6e'
         '4e5a3d48e51a56631c06d6bca7534db7'
         'fef91563b939d44d9b5b20eb9c3f79a4'
         'bb618319b2e64cddac0522292258469a'
         '4e15868041cc8ab083848dbc98d02058'
         'b7db88d9376065fe925a1ae5c40f0461'
         'e6c28591b937a33c2f16b9ab1270783a'
         '14fea8f8660a3d56a9af0e77838adca6'
         'bb5735eed41d349db0cafbfcdde2c368'
         '5788198697899cbefd35398a5474d54a'
         '9150f061bfe5b9bbb995fe43d0f8755e'
         '01689b52a6808d553cb4e51beab0c399'
         '8448517e665b2ebfad14f8dfc0b0f34b'
         '0c249c69126d3b075f7027af73f32e7f'
         'cea6a433a2bfe2b05e794121579c53be'
         'e4419f24c1aa2b35b958a0ec599e7a8e'
         '54eb317206b22a1f67a764408628c3d2'
         '6d16b9bd4d4c8df3fefef1c6329f2054'
         '26565d75ce29348c944cb1f77f26c64c'
         '0295b6e2021bdf0aa42e2a6cdeb73fb4'
         'f1fe3b539cc6ab200b1d69ea6acbb500'
         '7c3135740f368dd239d1411a67d02918'
         '7b8d5612f6e66af7031eec563276eb94'
         'c075d939ca612810d721f3499bd8a081'
         'a876e80386b1f4cfaa3932d84fbcbf34'
         '7919d41407534c34f9036cfb75a38e73'
         'e1e4b5b9609e28b21438948467e5af66'
         '89b34cc9e811aad180a5250977505dd1'
         '906a482e508deea6ad87582b64d9e5a0'
         '08ae3dd919cd6430674650cb975ab648'
         'f920f1fec66341f6652da713e1e8063a'
         '794eaaec7573c484cdec799977566737'
         '919e284674c94a612e0190d438cd0afd'
         '3a64d834189638df31f1d136297ea0ff'
         'e6138d59aa3026c74913f913efaf8cf6')
