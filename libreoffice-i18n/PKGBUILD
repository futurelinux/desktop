pkgbase="libreoffice-i18n"

_rcver=6.3.2.2
pkgver=6.3.2
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('f6ddfbdb12a3eeb587aa084fc5552fa7'
         '5f05e814dadc857a4fe39dbb22fb287f'
         'c24701dd199ef45cf01b89def19699da'
         '2b9fbc4c71a4f3a06525f17f84a52473'
         '2de02f141739aff19c136b7dc76fcf5d'
         'eca16787c99bd045f2bb89fcf91ad517'
         '6cbfeabaabd7d295adde17ca22af7957'
         '952a3e4b31d4870adae30d180a3fa388'
         '6699287f753ca093e275d00983f8c329'
         '77b083f2c6bd900fd468fca8ef23168a'
         '287a1705acfe05ae088a94cd93cebbf5'
         '7733662164c2c9a84f130db57996790b'
         '2471c20f123ca0d3d310502d2a7f51a3'
         '20b3371d64daa7ec3bfa3f3d547cc154'
         'c4ea9089de7dfaa81b5349717627ed48'
         'fc61a90b42fcd8401e775a135143e58f'
         '624fda9bd2198b057d834dd58c8fb3c8'
         'd19e4c8acc84c7f978f2765f2c8a46eb'
         '3c257f2f51b750b7b3055afb921b63cf'
         'c7525dff165116c402f44bd92c2628d0'
         '0dcac595116595bbfd8bb0bc0181a13a'
         'f38f870524db8b1e2185929dc73986bb'
         '0a24e6ab4178726b80abe557d774c250'
         'c3fb0fa08e77c6a9ad386508be74a3cf'
         'cf041c7b283ff4ad846e61b546d5ec5b'
         '44e4061aedb4352fd522213d29000e46'
         '94b9c8c63e9d386a136f6c09aa736c19'
         '30aac0f12f0fd57193e9dd592ef9e9ee'
         '9437829c428cd3a3b20b6b3e49ee6544'
         '7fee793722fe5354ab7af61e4b93b310'
         '844afd1bc597401b83960c13c45e42bb'
         'd5c19bc218f3d848dff8579b46cfdc79'
         '51d0cdaed48720867677b32fc942c25e'
         '43c71d45e9bbfa1d296779bba2d5e25a'
         'bf1fdabcebd7399ddeb0027940e2a0aa'
         '34b26ce80914d6a20ba9b595f1e914a1'
         'eae5f4e8c1a6a0f490e7e69b7b5421d6'
         '4d39d6844f5a948550e8dbd645788d36'
         'a7210a090c2d1990b60d7f5b16df6715'
         '26a09f932cf296bf3979efa8b9497376'
         '0763e0932fd88ddc8e740efaca35d96b'
         'fb00ac01462a7a75d2dedce54cca8af7'
         'f62ad94c3689f8627491582f0c17cfcd'
         '0a5f39f88ff761d91e7e8f47163fa016'
         '0d7a477756fe49f07086cb4826da1f2e'
         'e305e8afa8d617df07b4f125f0bc9a02'
         'b1492b98da833e545335846463eaa08e'
         'e015dee7b14c75ba14e1f17a74d00619'
         '99a66e814ba8a3c7767a1a172ad6fca9'
         '586469fd1a0f602917d451bbeaa354b4'
         'a7560cf9f0f8f54819aa82f1a20cd091'
         '105ec9ec87f1f82a59aaef257603370d'
         '6d2d0a5a012b8cda9b5e4079d01fbdb3'
         '89c4d76c24b85f87678da9cb62fdfb37'
         '844ec311786b285a328e0dcff9fee73d'
         'a38039eb716f708940c14bb432f5f6ff'
         'd2310dc8f746c916a058e33a80e1f44f'
         '15065f7177bfcc71e132d73a9e962160'
         '1ed9daf8be4e02f0a5e15d25b18a24b4'
         '5983f395b414825aeea24ef76233b3b0'
         'f609489473a39c80debda22124c51ef7'
         '4dcc576e0a38d724c742f0d32b26ddf6'
         '392f14d6189136ec4672ff8c394401ca'
         '0f2a41e478311a938f6c6a44fde7f3d6'
         '93272edbd03c6b2f1a632664418ebec1'
         'da19187d57b5037c2f011cec33d31deb'
         'daeddaf14d746e5687f62a3f99c48c0e'
         '582186490362527703be34efa1fd4e9d'
         'fe76068643101cb4db0ba675ba025f16'
         'd225660c63403aae2575261b24be46eb'
         '12fdb0d0708c12921e9b9c8c026e91dd'
         '707b67cb395941fdd366b1e9f01d8952'
         'c71b48c21ff370ee712d5bd73748b33f'
         '82f07aa94bdb980af6052bda24d1b588'
         'e32bc752360d6bcc53f1f8e7ca707593'
         '0b3d67a5444d40dbf28abd28fdd44a56'
         '9b6969bfabf54edf2a17eccc7846d071'
         'ac3291b65ecc7694d890c9ef8616844f'
         '4fa10c1823e78d3f984ac463d7f63143'
         'c23b791acbeb478a090f7b7dcfa657b2'
         '370a4d8008db6563261323c097450b50'
         '5c476efc9b4fcfffb876d235d266e633'
         'cd8314332a23f3d44e627a32274433e7'
         '0206dc34a2942da377b6d9896a78fda6'
         '238888557d45bcfb7163e21f63ebbf97'
         'd8116fbd7f083333c9f66a6cd700e844'
         '07d9f7e32c43cec0d60d4ec59b8ba7ca'
         '6c09149a46cbc3c202ccd4b2ac2be6dd'
         '9d218238c2e6f3d639300fce5a5e4161'
         'eb732e77fd2eab2a7c430c7e7ddec98d'
         'ec0dc8196f084887c88449d0399771e8'
         'be1cde8a540e427917e93ad6116c94bd'
         '1fb717d2e4078e374f725fac49b1134c'
         'f50d3f30e5f517a4a9cdcc6594947f33'
         '209a31e7f65ecd8cf67685d8d2dfbb3d'
         '13a28da3af5cd3aa4eb0f5adef17fb8a'
         '302aae960e167905672be0f0ec991e0f'
         '0edb74d863adad86e0485ea4893bb6b2'
         '1aa13fb73f0e8422fa17a134d7f0c2de'
         '47df5015c930feebd013555a35d703f6'
         '4a6dac7685c2d0ee605a2027f9424c50'
         '950f5807536625e98d648cf4f2f33398'
         'fce6d5d92e7a0313f62800a759f4c004'
         'be49999038f74b65d49fbe441bbc3a9a'
         '8fcc275c4f54622e23719d4d29f43583'
         '07524e9d9013bd2dab05bf02267309d1'
         'b726ac413272f6883fc2875e9d22aaff'
         'e1948e15ec6447ed1bcb83298c4410af'
         'f1121e457357efd78fe08d3d73bbc777'
         '161a580d1e3cbee4017179b836dd4ed0'
         '234159409893ac2bdf74e72b41d4fce2'
         '18d65bb50f246eb72df5035c4fa00320'
         'f464e1bc7d5bc28349d0ccea9d2447ee'
         '38ca4cdf4a01de578107e9ebbdf146b7'
         'b9f650472bc5fb61461a42e0e042768f'
         '7bcc4d2f1720d0567a14ca365234e1bf'
         '67f6d75d1da359953ae4bb5a589cb5a9'
         '629984286bacc7d116654b34f4093838'
         'f87edbd91612b891e5e0e90b0de5e1ba'
         '22af7082c355991a6b7e9356dd524853'
         '438f81da6d1fbb08e8cf6c043a13e966'
         'e3a29b84f6d557a08a5726f8d7e83cb0'
         '0843d628ccdf3fa23572f02723444b9c'
         '65577f2c1e7ffc6d7e6368f22e38c417'
         '290c7a2807e944bad67c737a1dde1537'
         'be1d9868cfb98816e3749db7d3ad8f74'
         '9d721dccab3d657b924da9ac3001ab2b'
         '92171c2dc6b0328cd3474339c17657a1'
         '5db038c05cef9805397892a630bf5989'
         'de92fe72d8e7389067dca3f588f212d9'
         '95f6f8da490f76b45493e2c3610869aa'
         '99c3ab90883fddde816c9b66bf2e3d23'
         'ff3416c2528898b8cb772f92cb87190c'
         '19154ef31342f0d678f22e3898b30d33'
         '0d0f1358e3601a124da927442d901088'
         '0a9225723c619b9894fb801c01fb2618'
         '6d6d1a794549bb586e542d6576e40cb0'
         '69d9eef577a8bcab4fde484face72f32'
         '7f1b1e06dcd251b1bc1743bd7515eade'
         'dcfaa3c4efdcc35babed6f4db58bbdc5'
         'e1c0f36f07920590d5bac5ba57062cea'
         'd6b6ce878a1461f67ff5b26d2e01de50'
         '431a9ea38aa6f490de0bd040e497533c'
         '83627d157f788c4e227cea1ceebdd491'
         'c711898894c446b21825a74804b8fa03'
         '8924670b2bfd4b36a164d2bff0407810'
         '188b3909ac9d4866c2151bf9a181312d'
         '6fe11d73375f4f9800fbf5db6bd34aaa'
         'b1c6ed66fae461210e7743ea3d625554'
         '12b44444c84a77cce3749c635ccf22aa'
         '97968fe3e11e65fdbde22af456824c5e'
         '1a068b3e2cf3aaacbad105c27f4bd262'
         '53e326e3d5a29ba244340b39b3af95a1'
         '7e094370f4b4271efe98589a40449d91'
         'bf07214bf9bdf18cfdef1e79f6f4921f'
         '6e3cbaf1d443472b3c6d16a9afab6a77'
         'cb44199406b81cd6ae448d9a1edee0d3'
         '53b7f298db73ad0b10cd774d2c061d10'
         '1ffaba58a64d8c6acf253a7f006aa602'
         'ea87b74e915bbdb006a6d031c5534dc8'
         '3d1a6b9223261b3c08cdcaaee6452f36'
         '96c4e4c45603636c2154ec2ae9496b91'
         'b3b90ba69ce15b2c45fb1fdb135ae6a0'
         '9dfbc1bd1eb6199e800c9f27cd223990'
         'd781e95d0b2ea53a53d8de57fee26c30'
         '9866b30ef296f3ccb1a697791c926c64'
         '50d6d85d3e50d099a8a7e9217807d6ee'
         '06ff3b5646a8278def26ce99b0f4b677'
         '54c8fd0d03564fb912e75300b9f7e597'
         'a0cd004aed1ec1f28b9b7d92377e4b77'
         '98841cd9b77d1f84b6744b4477ca7119'
         '8298b6ab13f964cbe225ba0fef17dcb0'
         'ff0f48c7cd76bd51ade43d6d0fc5b1d6'
         'b781d2c6f84e81d66204a5e933d2dd03'
         '19d69d3d462df9cc56fd0321b0055626'
         '8bfd503060caa719c9a23f090002994b'
         'ceb847a118e19b4c3a0fd9fe9d3efeae'
         '7208646024ae2b4e99e848fecc07a373'
         'd45555e548feb24f72fe05ba95c00061')
