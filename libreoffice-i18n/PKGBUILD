pkgbase="libreoffice-i18n"

_rcver=6.3.1.2
pkgver=6.3.1
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('ee1ca238a8a13bc592882b41920f7582'
         '258f1d0677750ee14ee32842281470a7'
         'b1903c14446b63bea33ec288861722d7'
         '19fd5075b8bcd9054ac3f62625472f33'
         '89fcf27c7278c27711e4c769b11ffd77'
         '5f1e2716369b311c7220e3b383583837'
         'ed5929565211f37372da48705392a986'
         'a08eb4f777cc82f584498f63cbe49d4c'
         '32984e99f56d6950c6f481fc5236c1ec'
         'acb45d9e32116eb7209da967bb3ea195'
         'dd589d782fc169a0bb0417a9cab9ab8a'
         'ec713c9fc9d85a512b78de767adab846'
         '1109a4b77970975ae0397e0ed2af1e43'
         'a416a5a31eedb2d0248477fd086d9476'
         '6c039abfa4bdfe5c10933c9c68ec1274'
         '6cb98cc966a297d08cce2eae1c156d5a'
         '62c0169fc7ab3a9d7c723c20dd270bd8'
         '5578fa51388a153c5a3c82cb4c472a83'
         'edde82ff6b70c28bcb0587ef50fc3a75'
         '336f3bed3289c95e0e3788b79fdc3685'
         '84305c803be70d4af4e8096c7cb91a11'
         '7de6b12b67dcbe4958dbe69af4b2bea4'
         '62b156e5919895c3624590648cc09dc6'
         '6531d27a1dcace240a4384598ea459df'
         'f84d7ecec9566d5196471deeb8e0a8f7'
         'd368f07e10eff55cba5eccf08a8656dc'
         '1c219211d503c720281aff8cb6f482ad'
         '73f4395ed4d796eb43de5304d1ec02b9'
         '99a568765f248ddfb8f1660b89a451a7'
         'e4686fcfd0499512fb49777e74b124d0'
         'e418924886919481d4b6985cd466025a'
         '7131e28be78462ee47fd07635e4184b8'
         'cafd596a4061224ff3e312ed6fa44bf7'
         'c1eecb4cc0b73ebfb0ad7c364bb93c88'
         '36999a2a032b56ff62a3aaf7684649a9'
         'e0fbecab5f1e6a6f3adeb2420ff7b9b4'
         '59288e821140218cda2f82193906092e'
         '8752d87cf9b7b182f11e34a2f88d4a0a'
         '9e2e400dd92e8ec5a55a163c8a1bafba'
         'e34c64c48346794ef0fb9d12a2cdf94c'
         '13265c7b8b288be3e55438aec96b48fc'
         'a92e566132c9b9b4e29b0b8cbb3ec92a'
         'b357aeb039ce2bdc9ff5d02c752f61b8'
         '4029b8552d67ed998fa361244a8faa11'
         '82af229f6c9e0166e502bf6b4299b99f'
         'bdc319984d1837a207da4b5bb004b672'
         'd3b75e04b0eef0fe01b42be698b9e8de'
         '1fe33024683c2c6d53865916cafc166c'
         'a8b273062a9baf6a851fdf11dd25ea4f'
         'db95bb9ecaec6a7bf6086a0e697b5791'
         '54da7602227371500518bac19a3f34d6'
         'b6eecec34d0a8beb21136d33d9705f5a'
         '845e1790fe6f73c3115c20594bb574b2'
         '9146578145d10c9b9831ffaf2a7a0156'
         'ce4f3a55a58889b414b6ca0aa58ffd7b'
         'ea901e57da8df340a4415b7bab1c6a7f'
         '815b6464a2c49867be8e0bd1fcdb9d77'
         'f5ac20292cc534b78f792da096f49834'
         'd3e49edf9cff572aefb6729db4d36299'
         '441f0fc76da3d322d02f15d15531444d'
         'bbca67adc60e28713b0f0b586443ddcc'
         'fe4707590d25287454cab68bbba28492'
         '646251ed90b20c68d6e9614540dbda04'
         'f3f5bf3fd1f0817b54924fca0abd204a'
         'd194e656b45ef4e91a3042004cdf627b'
         '3912a2acd406a5567ebe9773ac3a3c1d'
         'e76b4674a890b30994efe6ae92106729'
         'cd75e053d34be65b3c4a1124f5f1b064'
         '0640eb85bf117407363f241ad114abe5'
         '8853c6e3f951d2a9517b1ddc009e1f90'
         'a64dc932d0290b95467497da3e8fcfb1'
         '10ea9df5336c80cf493321a8a0354f97'
         '0e4cc588f90ada5e957e1623d02b4096'
         '284362d77f0e6000e553f92b846af878'
         'a0bd45e04601b9c4d71674d52bd3b077'
         '81584f7ec4fee48622093fb680552444'
         '67cc09201509148b78ac37aab01639b4'
         '7809c779e63c6ed652f380816628c487'
         '8df864dd86bc8f40778a18e1bd6a4abb'
         '2a667524c5d5f8e6f724bd56be596921'
         '0fa779fbcb6c48f4ac0144c9b6da2c72'
         '59c0318fe4afad13930286f79147cc57'
         '2a349d990cefad8f4bd136feb299b5a1'
         'e46550244031d5c058ee653f9dbf97f5'
         'f8d69a6300e9f980458bcbcbb8c423c5'
         '7a12da8b1ca662c60ff4d0af1146be91'
         'e16424eab3992c3b01fb68bf90166f0d'
         '13d425f84827ec4e1d2478a49ae02959'
         '6c7eeecf59c97f252a0ccc76fae52061'
         '32ffb58737636ccf96979f2dd1ceaf75'
         '2986a7d0020562ab0131228562de42d6'
         '200bd1ea2dbc4993d6a965c2ad231ed6'
         'ac9ad0e92a8997d423a1508ddc87d7b6'
         '884705160c6ee8f943340fb608274e61'
         '64f40ed0b11488de3fe4d5852aae2f10'
         '7055e17eb40e1894179f64869f72ffa5'
         '8b96b9ba8920edfa5a68820c9e5ed62e'
         '83ac3edda813ae0d9acf1a17a25ee218'
         'a0455ef67d1f9f2d87f8da2d9035ce60'
         'cb8f900e263d0bd5b0dd97c3c7dd4001'
         '4c943f2cebb89390d8489a851db79115'
         '5a4bfedabb6f46b0ae8c85e36b6b43be'
         '534c3b37de1620f54e9dd6932595bd99'
         '8abee03bbee7e82de7ed6425f89d94c2'
         '86af8c78b0a5b91f86d0b656a13b6ce3'
         '1bb0a5eeba695fceed91e490b5d97474'
         '0245f59fb0203f536542de269909d160'
         '64d2152e425bcf65cc1b1f465ff912b3'
         'fa160713689b1a35fb168ecc0231a970'
         'd1bcb8ad87d94513bb3637cd19ce8073'
         'c1bcded6e345d784f1e8865b805d8d37'
         '87823b3105f8fa0495cfe2ee5acdee12'
         '5e72b229531a59c5576cdccf69980485'
         'd3b9ab73ef502e10727634f98cc411d7'
         'ea273f1ca08bc9358377ff9ade571de5'
         '0458c5c1548d2f05fa07536a9779e4b2'
         'a870aeab8bc297f0b76aa31dcf0f34ea'
         'cbada8cd34aff3bacbedc9121a4d70cb'
         'b3d8429d5d301cd2bce895e164bff33a'
         '724fc264fcd4331f313268c8fedbfeb3'
         '810adf20c5b759dbc571949cadf0f53f'
         '8755504ebbbe936a37cc9491692084d6'
         '9fce0697658861736bc9ec03ea1cb347'
         'd7e9f705af726931e393b9685bc2a3d8'
         'c32ec77a0a183e7148c95ae81ff02cd1'
         '040c18a4b7c15d99fad65133ed185303'
         '809b2e367d297a319849a8851d5d7c6c'
         'dd01bdce1e52455c9248287dc6fdc163'
         '998e96f57e3ceec935a5b220c3d8728f'
         '0c84e959c8eac53a93a81978213c8e0d'
         'ef4fee09bca7007d052841645676bc79'
         '491afda48f43768b48581567ced1a563'
         '032903fbb990f28aad4b58a2cbd27d68'
         '03327869535695971fb2cd79b382b5f1'
         '3a5d8542d801df1ab235cc094cc91e10'
         '3ac82a8a79d23f0dd20389ce7a907933'
         'b4c12e3675a3ff8aa40f2e8537f36f8a'
         'e5187b407e0fa47606c5311162ef8e4a'
         '8613c3608d0b88c7c445a45e6402197a'
         '0c929a8b452e669d4a98c872f9889ac2'
         '1dfc1d776dfffe1a97a2185cba5dfdde'
         'adabc101f04e20d9e7ebe179ec6565d7'
         '28d0101ffa08bc56663cf0e13cf5479a'
         'f4a384560c9b5d9a0953494044fdc2fc'
         '4b845dc751e2b9bd156fd6be1ce0d9e2'
         'b6059786838ffa33c404226ec270f162'
         'd4c882cb7066ca7770966d4d4cf198aa'
         '07c7a914e026c76369e77b4afb2f4a04'
         'dc2affd65bbd2ca7c3d9f409713a48ed'
         '6e84a96e94f656b8404bf4fa350e3289'
         'c46a757b7a12df555353d4b031451a9c'
         '6805bf3966244b1599b82def26012989'
         'f1e9ea5edc73b19d4cc088021447cc31'
         '861d8b3839b1ea4c9404bb2166ae60d7'
         'd55f7c85fd35d19a1cfda3919a9ceff7'
         '34a17130c6210718921c3d62797c7a8c'
         '991c8415bc14d9de63c8074dedc4182f'
         'f532b26a5ed314fd23e2b62c0f1c92c6'
         'c0c3aa3fcb39edfc2d921421d91d6f38'
         'eb91b999bcda37c2a1c1eca4bdd2c514'
         'a7e6533b71c5bed444a15148c85254b5'
         'c8cf3440e26ca961cda665b45c5bc56e'
         'fba9d12d9d44e440cba63c0c6872d724'
         'feff79bb26328fc8eea8f360686a2c9e'
         'fb24062a6f0c57011ff01470ce4a50a4'
         'c7d40246a233b8904505a90dbf42ee37'
         '017060f37a03e9be722b2c243724239b'
         '156acf47b0c3fe5e78c1fe82cda2253a'
         '24d12bc440c29d33b16183461e48e66b'
         'a61808c98763a66b51f0e5ef989f0dae'
         '772416d5cb72b1fc0d3cda60dbdf80db'
         '1860f84da223b830777800ee70692cb7'
         '36b85780e14b40ff66c8f0e6df90dcd8'
         'fc56482dde993b8a4a9263ce5829e7c0'
         'aeca771aa9d414db431a02c8e1b1ec34'
         '251bf6b1b6dcd4d9f75f89f5e3ccff71'
         'c7f083a06b9b644f089e2aebb4366456'
         '2adbaec06e9b4dc12ab9efd201aa0146'
         '7aa1c1f65aaa351a65e2aadea7dcce2a')
