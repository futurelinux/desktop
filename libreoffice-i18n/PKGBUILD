pkgbase="libreoffice-i18n"

_rcver=6.4.2.2
pkgver=6.4.2
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('5cdb5e053f0d02c3c50093edeee1cdde'
         'bb54592ed7bd3d5abf32edd9b6fa8dee'
         '0aba5a809c1d7dfb565ef4fee975fc39'
         'd3b1f83fac6cfb5e7e8be1bf9d951dae'
         '856939e2b2342e57b0f514d0c52e36bc'
         '6dc0a5897e9e5cc6ecffe6e3baadc499'
         '72f4ab0812b35c40a2d2f53e2d8472b9'
         'ecd685e6d799afd878cb5e451412992b'
         '2bd69115bd5ef484804bc3b6ae7e33fa'
         'e220ef5ad72c6b1dc231588382a49733'
         'c78135a45f67c5401a801e322117346d'
         '01f937a9bc04c5c0727a4bac3e03e267'
         '2a0a99da01f908fc63eb14ab4e38d23d'
         '7c4e4d5f3d8308896be41f03b1f34392'
         '4b52b2b001170af2fd6d1d7a6dcfdbb4'
         '9261db73c10394c2c085e87f3a6bb440'
         'ebda680885eb9dfa7cea5e41f6525de0'
         'a9d8a8d4eb11cb60844f674bf6000899'
         '0b942619b59061e53c22943ebd39a6ab'
         'fd26017296f764489645b42df5848ee8'
         'bbc384050f496700e3ddbe675261bce0'
         'f9c2277bda6ea4e15b80be56643f2f70'
         '5ebbb40a7c0b2a1f8db9706929345ef2'
         '64a17a9ab64d2c96c321fe2459223c4f'
         '4578b3c2193b35363061e7b2e979efbc'
         '30000b0a5fb286102102faaf5b111761'
         '7be00ed441750769270a7f274f708dd6'
         'd0b427db10ac775bca456edb7a840138'
         'a0550851426feb1447a43c22ca7d7dba'
         'df096ad3ba3a0ed54ae127107708eb20'
         'ad86c2de96fad8d09eff9272d0bd95c8'
         'c0b22aa2adc777888cc1d339e3e51f86'
         '26e925b7af30b826fe25d274d3f95afe'
         '5f04b18bc4a0b47d77376216ae91e8d6'
         '31afb506a882d69a01fd8ebb390f063e'
         'f610b90fa56247df1c48c832fda9506d'
         '4c42e6b9715e4608ab70a141d403f81b'
         'ecb72abc6c25446272f591fef447e20c'
         'a39d4481e5abb4bd31c4c086edb4a156'
         'ab4a1f485a7aec0e6e240b845d53887c'
         '678846ec31a49d2557378736adf22b53'
         'b71ab71759e2ff36a85e4b54890886a1'
         '643467a9c7820a1a7b66f57c7fe6ae1d'
         '7009f63ec12c466b7ac711bc529b8ca4'
         'dd1ffdc44e51cfb8801d97db0d548829'
         '2cb2b8f4c364c1e95264d72eaedc8437'
         'c6b5d5619dd05485190d91b5bdba46d8'
         '38991c999ec1c06512426a2687a47ee8'
         '2a4a365cdfe4db33d65e6c8494a09cf0'
         '972a8ac8cec275933a9517460074c918'
         '8a7afdd8ee3a4ff8de47d8e60cf64fbf'
         '16d6fca5bd2857f8072abd9cd78a170a'
         'c48e68799fd3fd6cdf6bd728d64b430a'
         '7838a61483cd99753630b6e2a1b8512f'
         '5bd85c6111bd34134c01c393e0cbab34'
         '70df3eb6c0464107acbe66ec13191e76'
         'd405a479861be314a7f67b84a28f0087'
         'e56b5bcf51638f5f03ce326f8e334177'
         'c9b0a37ac526bfd20f1b32d9445541a4'
         '64971a0434f38e740193f0304674161c'
         '917ed588b43472a76b7634e03eaabc08'
         '7d3eb43ef7e95f04830abf3c893c810c'
         '9717384acf8e8ff00e5c31546f18626f'
         '2fbe474e3466daa0110b336560937250'
         'b4bc280dc9b79ac064335d57a04a290a'
         '74e426e41ef11fbd3431fae312b0c63e'
         '29e68857cdae8c21b41d253dc34488b7'
         'fdea27ca2404787eee79b9e9ef9f9277'
         'a9009a0cf6317fb0c2b1c76138b15ac0'
         'ce2d9d2e0c20ec0116af3eb86f7c9efc'
         '43279bb1865f30647eca40d1a03dff1b'
         '49905f0f5707fc0ae9c4a0386a91579c'
         '44e364956670b99b79aacf171355226b'
         'bf2f15fd2d5e239acf98458a4dfc5931'
         '5603f78c7acd9e8aa59effdf448169ed'
         '9ce0118458b5d43765a432e38fce686b'
         '33c24bd912594b9b55f13d40e68988ce'
         '8b44d220bdee1cb4dc3548abc47623d1'
         '6f166ab35b8e46266dc3039535f9263c'
         '62f443b94e5c45f51f006f835062b35c'
         '4e6e1a8b7cb2cea8316b52907c72c570'
         '4b0a83c664990ede55da4e20986d80be'
         '69b8218860bf7a80da03075cdaadfcd4'
         'b68abcb5f0ab10822f4799d2015065fb'
         'c56f4eb0426e70fdc4637bdad97fd77d'
         '73d991ec98b0faf56b43557f7d7563aa'
         'bf2bcb2a69dee53d1213292bb839006c'
         'bf97d9de8171e2bf201d3b384153e962'
         '90e6c3dc81b0e1a344162845838fefaa'
         'c0680aa8d74d00a978b684fcf05595fd'
         'fcbf04593437b5fafb2fd77aa04b0ef2'
         'ed8fd986ae3c27052ff744a656dc2b84'
         '62e0b6d396a71b80834ce205c8943d19'
         '490e40bd0d0710d628f918a2e813befa'
         '93e6c9a098535f18c60fdbb5c024ec4c'
         '7f825ba1640028e964cc199166e65da5'
         '4f48f2923298cd68813cc91f2dc640cf'
         '936d32d3d218e5e75402e5e582ca57b5'
         'c51c5163648af92da70506d210bde3d3'
         'ebd82f6521a0cbb8f14c367fb1315732'
         'e59346562da88034ff809dae39bc3100'
         'db6ad18a6c4246ff3dfb054cf2fed98a'
         'd93801bdac933ad3897769b6c32ff6a3'
         '54afb6de8670943348802c1788f6440a'
         '01400993f778eca3fcedb9d5a3bcbd56'
         '80756a38efcb746e37c9ee1d478404b3'
         'd6b23ce4868f4d1f8f6efe5211506692'
         'b7846973efb1cd27b2cae8aaa8aa2f67'
         'a7fac9461c5f405fd5caec8392766bdb'
         '16a97cdac25354c5c06cb8842b6253f2'
         'a86c47d4ac0c1473e95bb852907e14d2'
         '051aeb4657512d08684c950b385ffffb'
         '75779b4efd73b584295da06e4d0c4157'
         'fdab8b03e359b0f200240012190664b5'
         '74b77aec057646185fd4e5b970343fb6'
         '684b4fb56cf2e55ae958905a11026eec'
         '5d2d784e33870dac999bac600bcac696'
         '0458bcfe00ee036666ed892fafa7d232'
         'fbcf8cbad0a95fe2d78ee7c3c9d732aa'
         'f1fa61c03813592b7649ba81f57f1fc5'
         'd1ed2d02acf8f91ab76a780695fa876d'
         '45197574c12f4d2f2f7c2d6e858ad06e'
         'f85a6c4f0bfb1c9649197ce53e8def0d'
         'ccd7cc09bf851337a3e29a1fee934856'
         '7a88c0da75652bea75b2f7aeffceb7cb'
         '6957ae072cced10c0e33c7efd3a98760'
         'f9722a30d76fc1bd898f4078648df4f8'
         'bbb57ff6e8da80ad2c45302512af9216'
         '2ab3e8575362642f0a789f1e1f41f225'
         '1378598deb244d3e274a335ea9355ab6'
         'f0de030ff33414bfc2f7af435a8afde1'
         'ce3a4babfa1011b9625cf8f262bd7711'
         'ad929e501043ef6697c650326cd9635f'
         '7ff650e749f3d2a4b228a709b7ffdeef'
         'c1e8912065f8111ec6e1e0743137c96d'
         'f8c64191c195b6229edebd215bbedaf7'
         '33073d9a3ab900047bd7c62da4ed19e8'
         '74fd72395e812fa2b5b330e7210b3d77'
         '1c71525b954d3886415ac9479c114833'
         '72717157509cbbeda55cfc9cc990f99b'
         'e71b7d63f7f2c27407cc8955d7343394'
         '87e1f5aab75aaf95c767de8efd139e59'
         '8a1295d7b02b226c98c6e25f1e5a1e02'
         '05be96c6bbc267ff4ba1b42d9dae1214'
         '7537f11219ea24d987048a34bbd070b9'
         'cfd94c878a29c43ca6d61692227449cd'
         '38363048b8d9099fc7d02fb0df9124c3'
         '7075761f10fad3ca5e10b27e5079fb20'
         '739a0108efa136972276e3ce9af0a21a'
         '5c3b6fecc0842259ebbe7deba4fa4b73'
         'cd2138a7c1df44915de9a1b49f608908'
         'be98771b8447b837b1ca8cfbc8ab1e21'
         '2646454c99b25e60c76b573d7d994b70'
         '665f4c08b9514eff50bedf71542bb79f'
         '383bc7c86b9d5ae19cd4a1c1355f36e5'
         '4284729320cd7ac7cea80eb7d5b904af'
         '48d418ff330bb7acd2de4e58d4981a98'
         '9297c7d8ca0770d11edd2b3fb084376c'
         'd0bba3793069a27381472d2c973f0e16'
         'a2c86a3f4b729e554e03d6a3f8ede33c'
         '7e1b0e29f597a726a125018dac688e71'
         '7a2609155ae605deddcbf706551e51ea'
         '5c57cbb5dfec6772f3adccbb13a2e948'
         '7d3986d69a8003f37dfc101497c8e261'
         '4ce608bb8e382b854a1be54b9b2630b2'
         'a88b4be0f62696b42615d95dcd31fd13'
         '49f833f99d2b70a55787ff7e991fed94'
         '2b14a32fa47c79358fdfa7b2087e8098'
         '123bc6ba01de90541f3c8a5a4f632560'
         'b0041cf6368cc37d68f08c83e4c50e24'
         '5c3e7ea16ed1a6138986868af7ca8d61'
         '08aea6a202709e0b78fcdd74856e4614'
         'fff8458714fabd3f59cf71dd2344b97d'
         '3d959ec269da1913b8a9ab4608cc3aca'
         'a12a6c2ff4f4bb7b5a04f06d172170d7'
         'e24ba3e1d25f45f0e7515081273336e8'
         '8fff4c940e8b875572ee0871cd749b15'
         '7c52e9bcca6fd3da475587c3d236117e'
         '8ef1dcbd1037c79be241eeb992d82d83')
