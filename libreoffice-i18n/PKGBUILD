pkgbase="libreoffice-i18n"

_rcver=6.3.3.2
pkgver=6.3.3
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('22171b0b5cd27974958aa372cd61e9e0'
         'c3f222f6bb94c67df50029339c45351d'
         'edf21009e6f17634a1635ad9cddeaccf'
         'fd1eb6175468042ecabbcb98f7cc7727'
         '4e840f8b183c0c6526dcdf4e11f5fdf2'
         'baa1b107c956130f9f6665d052bf64ef'
         '493955464992004fa634d5eb63aa70c3'
         'e14e0e7234437646c4d22e4de9178019'
         '3d04d7c6370323c65435315fec3e5cd2'
         '0885b33a178ddaf7c34cdac285a7356b'
         '0f24b90ec824f31840b1cf2a64a860ed'
         '2cc95d4072ad33d20aa989109778689c'
         '7a09e53ec6a118d7b7d9e9463896ee69'
         '434f1f1fe60e912ea7705db54f785100'
         '43d2afb0b9409f741274578a9851806a'
         '4ed1f7eacf195c793aa96885d3f5cb94'
         '51a0b23d69409c9ef67a306733f6dd2c'
         '00f2cacaccf1ebea89492969b8f401a4'
         '5de8033dac17f31549d188dcc37cd8bc'
         'f4093813397afe2e2297402052cc8b9a'
         'd0f2a63754c40fc1a99eec175c87c300'
         '5a403c17d373ce5da6dd04fcef60931b'
         'dbd9fe41116eb748d53768ed888ff78a'
         '954725382095e63cdf0434d655566035'
         '22b6ae649538b2d538402ee968e6cb75'
         '37ed32df157044475d55d74e29878997'
         'fe8e146207820cd9a6a903dbf1abbb1e'
         '3d8f990ad7eb5de56528b66e3bc29aae'
         '068a083a0519af536d0b96c357ae4e34'
         '652d207af054b9147a3ba054bc1795ba'
         'fec1be23c76440392177e99bd271eb7c'
         '52d5f519e9cd22217fc7fb9a3a5ecc1a'
         'f1febfde3d2cad9586835601af2fb0a5'
         'de11f6ee23cea884ecf2975ca7fcf235'
         '36598129c5edcf2fb7b15ae6d9d64551'
         '0d5da927bfa6e6077653d395bcf21ef2'
         'bc5f6064d268cc82f2888e9eecebc132'
         'fa011332a16cc24980ee1484ae23fe7b'
         'b500f9b1ebb78001766f587341364e70'
         '5b476e78e8c0187dc56f4bf52df43bdb'
         '99749f84e90e1bb15ced62dab9becb7d'
         '170f9cb7abbb74dda2bb25cd6687ffc4'
         'ac5c973ee9d0babc3d41a97ecd098312'
         'e0953c34ffa2ca6a6985162078e87390'
         '5c5f4c96b5aa8f7f1b1a29c56196e55d'
         '6a859067891748d09e5c9e02da31eb8b'
         '0d535f29971de319597b4e23e36b2862'
         '68bca405fe12f02705d9a62b5f804e67'
         'a6c8cc933589b79c796be9063a7ef234'
         '39ba9fe9867e1eb1b8f40452998ec82b'
         '03b10a7dd6a40fb80f34e2888cee4037'
         '2f4094b794176733de8e451c286e51ed'
         'd2fc025d171baaa1a311f294622edc19'
         '28e1c5bd517d1edadb29c38243d7e93f'
         'd0aea2409dd72bf7d2b75d598167dae3'
         '0dd39f1cf6fc26e12655856508e0ed0b'
         '1a819f58a41a50513cd692ed548d76c7'
         'e48c9642035b8f61871d507e3a98c807'
         'b9c25667100e2978b6e7773135ec18c9'
         '3fae91f0fc8bb045ee22fb269adbe395'
         '11ac3f2cfc0a88827e6ea74e01e7345e'
         '1af34ed2f9783c9e8972497036dd924f'
         '8711f54465221c8624784e91f3f830ed'
         '5542ae21a6847ebfcd76659ea39d31a7'
         '8eb620681c0f220decc0f9bb80e1e10a'
         '5b802252157351c4bb157e353ef79f6e'
         '5e0f9081a1fa9c960238e3645348965b'
         'e9e3120174425b22c2f7f2ee430b46e2'
         '04dd950ad4cae6a34599449b17912a51'
         '909dbbdc3f66526a7849aff82835bfa7'
         '966b537c2cf5583858b6839f280713d8'
         '804b3571e7b4ce0ca80f75b24b024ef2'
         '0345a25237de9da85d176cb99b687e31'
         '3f173cf752afff8283e33e46a29ef7fb'
         'd4fda3dc6629fc25f734447099ea5933'
         '51b4ac15be452e58af3af13c958eff90'
         'e71169dd93edd96e51421404f136b5fc'
         'd2bde6e98529c0e73a268361e5d6fc53'
         '16af31aeede21e236bbba04080b053e1'
         '5e8527cde553b74facb6bda2a6b2a922'
         '9c12fc8937d2d5870bd21b4a4d5d9f67'
         'cd5e365a11da62a8fdba06bf8cf5334d'
         '13a2408b0ae3838d2a9f700b9b14c218'
         'f1951003cf04d676699d64930f76fb9a'
         '896417b35a3351e4f949edf7f92eee9f'
         '34aeac49a19f8c938298ecce66466eba'
         '979209d856af1c95d53f81a2f9f15895'
         'eed03271b6ff54b2290609e8cf166b3f'
         '78339cae3aa97302c2ccb2ca0ae443a3'
         'f28048b33e39498da70d0822e3c14aab'
         '74dfb44ae9130841ab412c2bab96360b'
         '229cce61dff9a29198e2862322fcc6c0'
         '7a8981475a8beb807a88aa74fbcea1ce'
         '54ece9fbd4f1c32bc10eea2b9b29b2f9'
         '6f86492ddc944fa7a373dc6c999c78b8'
         '81d5744681cdf18c17f90b6c0229ffd8'
         '94b3e92af7773c78f8b5c28e2ca8de9c'
         '1687e87e88e5623a63f0d08e1f94b684'
         '3fd6238787817e47fa7557cb66c994fb'
         'ba58ffcde0bcc09bb1292b3db969fae6'
         '976751d2ff47877af9cb2e683cb71438'
         '973d6c163282d2fd922fa751b4146148'
         '320c79beaabfa711dcb38382f40e9978'
         'cf1df041349f144db8620cc5fed75397'
         'ff9bd1f860a01596ae2c16479b994c12'
         '6c2e35f69957e73dd03089ec0bf950f4'
         'd10d95561ae0b50efefc7afff1ae2703'
         'e90d9cbe39ea6ba972558f95b98d4f1b'
         '1191a8e10eb6e50652a8a0fd799a6086'
         'ba352094105bff7abfc1c79e16d31e43'
         '9804d0dc82bf55550991d8643970172d'
         '00a00fe8ccf0b687e432d5e7f485e61b'
         '34b1bda9cc532fc6a6bda66021542785'
         'f9c162437a291a739603ede4590fba9f'
         '476ecfcd68915946c7f47528b5d283ee'
         'd63c742141128bc156c509c936f6cf22'
         '6208ae40067af9812f6daf871ac00a27'
         '4775169e0ac118861d9b53f0a653b675'
         '18b8e92fa55375bd8bd3131a1d5f9ee1'
         'b0013084fc0077ed3bace774f00f0652'
         '5093df094305d5fdde4c9ddd5485e7e4'
         '249b021d9d5cb65c7cda901eccd474e3'
         'c7ac69a2ce1ad02686e988094945fa97'
         'bb0a1f1609cd517712e5f2a24446fd49'
         '53dd4b6cb6fe09175f3a04c2cfd8d425'
         '012d2b29bdc89dc2ded1ce6a33639957'
         'e5b069896501901c42d212ae8520d6a9'
         '9cfe6a2ec548faa7f04674239c71f0ff'
         '96a6062946e27fa4bb8696d1d9ea2696'
         '535fd4de2cbb167ba8272ce3a34d174e'
         'e6092dce1af47ac367403870021adffb'
         '97a47012dbca6dd9ca3746e61ee31cf0'
         '8184091f647b1ad96e8099bee8aa8592'
         '8c380cc3090bae9b50c1c5f290d7c00c'
         '841fea1e9c58c0ce333f9ec5197db371'
         'c5f67ed054cf2d33360d3ecc399f27f1'
         'b4ac8c7e7163b9cf4d7fb7380f5ee0ca'
         'c83f6b90d959a919f014e6188ec5adee'
         'f4e34416ee7ccb3d2b53bc2cd71020cb'
         '74296e99603c6aa2a86dad25e9612152'
         'e326a896bc7ad8659a6c5293b4c93deb'
         'ed8fe8110f675e651c6fbdb64c1f17ce'
         '9ddca542703d1d945221637a438dd8f8'
         '212f9381c6eebd1a0dde62e08096429a'
         '52fe0259131733cbf9a58fba1f30f621'
         '46f4c6c0655766ea206d96c77549f36c'
         '189c63c30454337d7647f16b019cd580'
         '4006d48ff8f6fd32ca1ac594a9729146'
         '162604fb61194276e324cbe40f4be906'
         '4167939095f063855fa461919f225f33'
         '716030ea6c1ae035e3d74c7618056708'
         'f13664d09210eaf5c8b66682f50e401e'
         'aab8369cb5078cb7fc521880f85971df'
         'bb79a9cbe7ada80c2f656df68ec03eba'
         '37bf06aa2e1f799a970812f1a95d5da8'
         '4e5e2266587c35cf0a131604417cef40'
         'e3c51b2f110f7b9623057c8598993afb'
         'e8c30998b9e7ec9b266eb4210bb22ad1'
         '5f7c0617384ab6afcb9a88aeaeb7e070'
         'a4c496506de5f1616bdd32e8a0655dc7'
         '1fba9c037fbe8f67cfc1de6db7f57082'
         'd5fc2772ef2c81428cdaec825bd35e7b'
         '5d5a7fba08b21fd15059e02eecea96ce'
         'e57bce38b7b7c7798018730e0677e098'
         '09c5c98967b2ec1aaa7f79fe5e353d4d'
         '10421060519992c8dc56ab31c4f48db7'
         'c0c265082aea7f173329ab755f45b393'
         '20a26593f1766fa5e15a1a0f64dd277d'
         'f2d4f1599bbb3850cfc432e5b16fb223'
         'd7945f9790acf0ae5c763e46dfaf7f63'
         'b310d12149c3e21692a18898fc06149e'
         '32a13cdb3074671cc91502002b4a9e55'
         '477dca11734223e571673032a7faf84d'
         '64f12d3840644d86359e091488eb991a'
         '22a1a7cfa640718ebad3be58fc76e3a4'
         '485313260ba417a28c87abfdc6e40fa8'
         '0d12279cc6a175ee22cb90e5e319fa30'
         '36f6b289b5b540084ccd05aae7ac2617'
         'b48cc8d52b0081107b33587dd9b60fa6')
