pkgbase="libreoffice-i18n"

_rcver=6.4.1.2
pkgver=6.4.1
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('00aa473295d231435d80b45e8250110a'
         '7b31b6d58625b9524fc284b1c0199eb0'
         '06b9357c4cb867fc03cdc0f69783fc7d'
         '0f9436f225d2a313b8fc0172fadaef40'
         'ef737e3e59b728480182ff36f10b1f66'
         '68716973e97fe4a35640d08999b5754c'
         'd931520c4c357702cf3b3b40d93c9f4c'
         'dce7c9f372a29ca5a17fe14ba33d856a'
         'e74d10f61dc932434b2a594274044d1e'
         'a4bb5be8e7f94d23819faac896e73f8c'
         '7efe3b7117747764243b88770c83fedc'
         '15e81d9c6af6e4260023a0e2b121c19b'
         '94bb56d35e37d2fd69d3e78671672769'
         '9283f6d97bbce6e22759f8c0bba7b8d0'
         '61cb9d4f43e15025117bcc5b004c8644'
         '3e9c91ba047a41274bf7ddc61d7699bf'
         'fc65d333a2c8c092f68d56b986596d1f'
         '1295cdbf425dbc44497c69eac57ab36f'
         '686f720525c59d58704a4d1f61103580'
         'ea1d0f8f466aecbf175041c97e130d0b'
         '3e1409ac148284f09f3c48903e100c70'
         'b8e8cc0bd146cf1f0687fb6afe7e1572'
         'c5feefb0d685b48269706bfa35809a21'
         'ea8b601134abfc2843a97d7562b9fb41'
         '69fcba300d8dbe8a7f8e34651c94f1a1'
         '93b4118f387d591f2ed2161cf82de1c4'
         'f109ce353d9bd329febd209d2589f98e'
         'd669b07b61cc17e67c540a0639b32980'
         'c413418a09b0f4d321a763e39ea3fb39'
         '7dadcc4fb400eaa847de2096328578bc'
         'ea50958ca8c966abbd4feb62f108088f'
         'be1f59b69cafb312432928fb04a163a5'
         '18e62d5888d7a24f19a1d739d5e2d726'
         'b701f66450cf03fd9a340e5fa34eafb9'
         '3e0baa9460090d43810c6ddd7ca6cddc'
         'd3c208c4f2a108748af461e0b84bb27d'
         'd67975bb9eaee0e85a8ed8ee6c17c344'
         '7efb825c5fd9a4513ca79f2ff7b1fb59'
         '19f1e00bd92d5ef406b6bf9b22e0c29b'
         'bde073d6a327a9eec3590ed0b71301d5'
         '9fba319a3af6cfdb64f66ea084b8a13b'
         'db91a3f3626777e4ccc05f63a79ce739'
         '9333c14f2c60b84c9a19777404bc9735'
         '91514bb598ec62d1f40334454f3e8299'
         '50b3c94b0290e6fe8b8ea058faa2dc70'
         '7d01bb4a8722069f3bddd42bd1f2e13e'
         '4b382e3d1a32b6f364180ba356f9dc1b'
         '26e277a2930798105c07079a648152a2'
         '74cc29f7e06847175eee6d9291907e6c'
         '7d6625f5586d3784ef527ff784383455'
         '537110566d83978591d8807ff325c9d2'
         'b11fabcf82d22c3f5509f3183aaa6fa5'
         '95a5660bfd0692efd9c78be3a6e6a356'
         '46c1af50283915daeb49715e10d27c60'
         '74835ceac81b80b2514528d6e3495bfb'
         'da1795a07d55383f558b323f74b805a8'
         '042fd50f1a80d88248abf704e4b49bab'
         '0b0b4ea7fb3ad65d83dee4d9ff8571a9'
         '209553115c214b4703882738d8accad4'
         '34801a4b72581cfa27930558e7d59535'
         '928840e6fa758f693cd92c90fe498cc7'
         'fc2fc579d37631499e8cb48106e7eb82'
         '42433bfd216c489971d1ae3e2bd9f789'
         'f9451ff69f9d8d4628646bbff27be200'
         'dcf461b0f90db641aaf67399b1f8ce80'
         '17e256decebd03df6530cca87cb4d6f5'
         'd552835e2daee278c11cb02c920da4b6'
         'f90fa3f0182f6b3d349a1051df95d742'
         '25054f8ed8790bae6a91cb47e1d0e6eb'
         '969e6d231bc4cee05305c218748992da'
         'b71e8d7445e342948062512505a68604'
         '21ad0debd39a6ee37e408f7c84a7059d'
         'a25fffadd09170f6e15d07c4432699d8'
         '1dbc4bddc8d5227c060cebb388d2540e'
         'd3c67a24aa242c8ef2d56becfae00c1e'
         '46dc209e026a047278fb6f863038c94a'
         '4dfb06d2a117bd2abad158da5f62639e'
         '73e958f8f204bdff96a36b3810edf20d'
         'd5f519c8877be4be44ae659eb16fb589'
         'd31d4b512559fdcf9bf294f551446923'
         '85134effe074fdf624fb84e0bfa839f3'
         'e50bd3e2d23909035736452321162080'
         '478105ab09326f85e5efbfd00bbe87c8'
         '0d61ab4d91c74e4034b9cc96dfa72e25'
         '4f105389fd771bf137b59209fa11f19c'
         '8a14fdb82ba31e762e9384f4d54940b2'
         'cad8c5a16a3332c1f6e2fd6261b0cd1e'
         'bf5bb9d0adce1241fefc2a008896de89'
         'c6ea32f0460a32df4c2e7ed36314fcb5'
         '9cc4ec308c6bcef7017485761f75a005'
         'c6012ad32e5490b8fd2bcbf986e9c381'
         '9006435873f3cd9d57cc4bb3c710a9c0'
         'c0ec4f51ff5f131390b1d899e5123f6b'
         '9348760c9c39d8dea5c4bc96fda7526c'
         '9165ad7d2a4641e4cecc3aa3c69aebe4'
         '61d016da120add16c3c8e38106a48eb1'
         '86e91b9d7e0cced5b1a86148e9d2d7f6'
         '1c866e3cdadf8e2555a27fed497fdb4a'
         'b09bf90e205edf4332bf3f26322e45e9'
         '2dfce3af14060720cde0c6ea4edb43b8'
         '94b260e2d7217914248174425cc91720'
         'bbdc0e301d53981ade0d791b77f2a856'
         '56713894e99a5d13ebf47749cdae0481'
         '3b2f278595d3bc98aff4283b1e6b944c'
         'c8adcc38be977ca2e44fa3a54759edeb'
         '6bd5f515cb8df78611bc0a7977189710'
         '7502a99bbbc82d735682bb2c6f1f184f'
         'cdedbb2834554dbd0d979859cf35178a'
         'eff9fde26c78c2ce948c6b872d3dd106'
         '72fc4eacdde0bb1b600278dc3f46ba17'
         '50c69e0805b9864da9559c8730337809'
         '555aa1374e5fe28bc74381d435f78f57'
         '30359ffe0b5b3e558bd0266ea2a3bee9'
         'fc566f4fe5a90b28a677ffa3dbca7186'
         '15eb86a404f4c414c552c761f79ec822'
         '036c58a65b2908211d59f673a0418c4b'
         '9084b8d8b345bc0c56631a79e2f54973'
         '072d74f6e5ee51e5b5dfefbf3d7b23c9'
         '8b8362c9be04e551245aa0c61efef179'
         '3c678cb0d8139c07fbc849923bfa6512'
         '055bc0e858ff26550745fbe7c96d705c'
         '51e2888ad815ac078bdbecbbe1795e0f'
         'd0299bc34eb75d5963dd0a2c2e95aff4'
         '2fe753c165d0ac405e7b9f12d259129b'
         '3957f536c1272daae675ce15e9441c65'
         '7251e3a732316999e719709fa368ca15'
         '415a21d9af6818dc8d0f4af1da20d592'
         '5a5ae705687c866a04b26c217485f3b2'
         '5e4c5d82b29a2a5152efb8ecf2235e70'
         'b9113748cff1083ab598ae8e8e7acb12'
         '74abece054b48ddbe41ae337e25fc58d'
         'aca29908fea8cd2e5cdd1bb0d227b002'
         'baf28c06a9fc50ef9d2bab18d6ee39f1'
         '74bce11c9a1ba70f5e01e2a723841efb'
         '0017e1621c665ad329453bf91273064f'
         '214c3286782df0ec5cfa0db6f796730c'
         '3a8535868c3c46fc6dac8b0df7224735'
         'eb6942266b117d1635b7828b08a50ec5'
         '0f9ed64bbac91375b7248c8831321733'
         '634ccab7cb04adad310c6e56ee749bfd'
         'e668f4e20192ebf9f7cc41de948419a1'
         '9d213ca6e361934ba3d9fcad3ec9c787'
         '4da3a6a7f6b868e795f642a85f4b7122'
         'd81e2ceae7e8941f85a8415744801770'
         '21e21735c707ebf4f3dbe60af7a3e4ed'
         '41cbc3bc61e7704b82b2cc6a3ec1b0db'
         '3307b91165e3f3550aa2efcd2a7db0aa'
         '853f865b1e7a1b57b356cfc8c8041496'
         '6b6ec0e57e40522277c68028c3ad7c82'
         '3b2f3ded2e59577e55cc2de26a59bb0c'
         '4746693450bfab20f109212aeada04c0'
         '0a0295f60758af6d88efe18142479a26'
         'ac6fe2fc43406e431fcb59eb12c62c10'
         '4f1ffa97bc57684c724873ae9ac4c837'
         '8b74040f18c4bceb2378c99dace441c9'
         '59e60c3cb4b4aa52f1c69fe3639e3d5b'
         '01251180227fe7bfe8e43a9c768d975c'
         '207dacaff200cf64269066f9787fd611'
         'ba8cd3d173fa20e843301922a487b74b'
         '453637cc09772516a10e3062e2380136'
         '2fbda73183067b7bdab814710398c87d'
         'e7cd52f67cca794214d602d376453484'
         'a9b93c6148fa4fbc27257e4c7b5d994b'
         '53144c07daa537878b701017eb0a8d29'
         'a00d37fe7317df3099e8fad4f9515f3d'
         'cb2f36096b28013e99c58d2f9dfdaae0'
         '61390b4aeee2584b6b695bab736935af'
         '4c88022ef8ccb5e049c07359a480ff7a'
         '8056c16736b94d34e331e1436df7b4e2'
         '22b0db7478e44a9862f35279ecf726ce'
         'bea10e43c610ac7fba41acba3d7f4fee'
         '56c05df389e9312e65f0079e74d2880e'
         '22b482c94fa7864a9e9c33a9781f58ec'
         '2b083625323bf49a7fe9b1f883d3f1ca'
         '21ed998e4f63b490299e36456b780954'
         'e10b74f9632bc259f8ea386d0ac9ef28'
         '6ed90354ec5bb92a2da7319de46c9b22'
         '4833276ba65792e815d94d4fc169da53'
         'd8a1057b3d18bb2882377f43b5ba887c')
