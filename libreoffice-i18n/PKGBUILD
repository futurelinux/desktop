pkgbase="libreoffice-i18n"

_rcver=6.2.5.2
pkgver=6.2.5
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('8d6b5b88a48371aa026c1d9bedf8f20a'
         '123d6e1b33651a3976620ac4579a3b98'
         '9924e10056e09a1117cc1cd4bc3f6cd3'
         '3ee48231dd4f1a635d5601b5c7c571e5'
         'ee80fb0755fc4759402dc8cc3eaf85bd'
         '756fca7dad16529111cad2afd604cb3f'
         '770f718af8c9536b02e25a7e7b1e7ee6'
         '7c88ff2231478eb36557bc1e1880392b'
         '79c4f0d3895091228fbafe2537d8cc3a'
         '66486851121df7e11f3c75e41f8d670c'
         '9ca5aeea1d889d3fcac31a19941c89a0'
         '6ce78e5b80a39ad2f08e357c954fefc8'
         '9c7c4a0f90905272f2c72139864c9f61'
         'c66e856686d3568d65b196d2d91895d1'
         '761be8aa32ff34c11f6725d5eca42767'
         'd779974064f9c58a8d97b55d3d83e490'
         '87f52093a08283d7da6742c29068d5e7'
         '47efe0770b9165600e5bebc340ec51b0'
         'f30464cd4d0b11667f01ccec50239c9a'
         '5a8c837351d4ac2d32a4c8557cf8da36'
         '43078634cb8756a5bce4a8d40c5622d9'
         '32e2ccece23cf0136db84150464de6a5'
         '8c9540c9b4b0fe5261c28d8b1b4b708a'
         '7387e968946f5dfe4a011dfd7387fa27'
         'a8e2fac01b604815f9de25ae5e90e297'
         'fe4f124bd898e2698397e3dbc876f40b'
         'dfec7f8c251043da953ce0289a30e324'
         'd84710dec17371457327c3b91d9341ca'
         'abe4b2cda6ca21e7917a1893da67bd76'
         '4b7ab32713c67884bf9d18e962e631ed'
         'e5615181ec4b1c4c4773839dcb012224'
         'cb617cb4647d8c972901b0810bb69b5f'
         'ea77de1f765fca35e2e6119faf613ae7'
         '6959bfbddd78b4d5bb54ffe338a14f70'
         '814a3c7cf23794f7aabe28df1a771ca2'
         'b402e25b0ea82b37ea0db38887551a4c'
         '7cb32a3395d351a735602faa76aec6c2'
         '8799966087f69172aed8f3eee2386f3c'
         '640c6d17b417e482510459ab2bd6597c'
         '1bea45d8983cb39a4e0270094cfdc7e4'
         '2ee4ab4c3a3ed6ca7d3ae6951dfa50b0'
         '70dbd48b3d6a3908153d284e0ead5a1b'
         '69e4364c835dbae72a9f509611c672ad'
         '60b93aceb15fd19496a79c3fa61cc8d6'
         '2c9a7177b4d21739da39cc4ce73a6430'
         '82c8effbfd38741280188e3b32a831c3'
         '42b2857f42465f314f5901abc81982af'
         '0485725190f6a56badbd24982ddaef78'
         '28d2c446ebc600d3621306195c87b175'
         '007bf330b997e72eb73544ffe17e6d9d'
         'b5325b5c03de143d68f7416a931fa0d8'
         'f1e692024ec5dadc2edc0b2456bbb7e4'
         'de8eaab2348e44d05af36635bdf0e197'
         '243731247101cfb204619a589486cc20'
         '6b0d40b214e554a512057b5beaeaf74b'
         'd7b8c205d84d9373f8f63dcb33ca7302'
         'b9a852dececf75a003cc250fb4778e06'
         'bf8cef0f28a1aea4cd8fa9a5221c3d03'
         '03591e622b90dde2db7b919644c8f64f'
         '5e14b3d2294009cc045cf3b54df690d6'
         'e69252d37e5db89746c3f73fe9638597'
         '5c99c1d77578c61cc50d7b686472f2b0'
         '9553d2ed1bc0f7176509094d4a697483'
         'ff76dbfcc27302a7db1bfa8982341a4c'
         '719358cf7d4f12048679e1f994c1d674'
         '0a52eb07737aa01de9785d8a95c4d3b5'
         '6c81435386d4fea93ef4c53ac5e3a7b1'
         '1ce9f31015afbbb0a517471a9c8f2000'
         'f27448095d245c0cb7776d9005bba1c8'
         'eb12ec55a8c6f37307b377d5d7583439'
         'f00d0e35a24d4a663738fedf79a8ff86'
         '78d68376897d6e4737e8bdb2f47cabbd'
         'f35ee6491e348dd45116653f12fc81c2'
         '8babac95e4c4848f1f377ae8268433c5'
         '1983c4e22f837cc5333ef9c8227750a1'
         'b5c78641b09117f32def5c2e8d178be1'
         '0f3658fbf71e493cedc604fc8fc8f894'
         'f3111aee48292aefc21f19f3459b2e59'
         '0655525012ad546cde735973563fdd25'
         '42a6940335ad778840734379ab61457f'
         'fdf08a1e17f5e6efd3244d0839e00136'
         'e2a9aca3d274e3b18730e466b0e8a1b7'
         '2960a8cf7c020a33c9e91019ca6997b9'
         '89ee40d01d272789c63ff4884b43a297'
         'db625e28ac0b58406a8e31c3c73f303f'
         '3ab67e66c639c6e64eea9a00d196eca6'
         'cccd0e1730eafa0a0869ffda31ed75d9'
         '5168f2a80e3fdaebde42cb36582e9138'
         '8e6e3eccd17ffc2505fd449e673b8054'
         '016ab793fb6cebae2950af9bdf42c021'
         '88a35ba338ff4e050a4a3ae41d7ca954'
         'c9f93d9b2e0ae31a62ca338aa114b17e'
         'a4bf56a181746ebb7cd0460aa83919ab'
         '5d93cd5f57e9b965922d4ddd039612ac'
         'bed0fdaef9967c610afc3eabcd6e5b3b'
         '3899fb5738eb79ac5f41f93b660d2224'
         '2660d38fd4ccff5f4a71633db85fa14a'
         '112e162441e567a62741ef72ed5817c5'
         '89a2d44ad603de9689788e5987328a3a'
         '9c5a1929be6d8a7a8ca441aab9bfd09e'
         'b7dec7e5f711c0608912c620cfad75ea'
         'c0d2ce932bb11d11a7eb272fa2b2d089'
         'f0aa8f5362190c72825e7344298d86fe'
         '87801939e76019d6d1710b03cec0584b'
         'fde65a73249629445cea68a6d447069a'
         'd397dcecf38dc2bb7466ed36253589be'
         'c05bb30d8730f0086ea545b57109f7aa'
         'a7661c8ba02241810d1a838d9c083b09'
         '0b6e5fc4a9aa955b4b958103c82be6c4'
         '2d55f2542419857e139a9d77d66efb59'
         '456a07bd8bc1bb8194c3f96c15582a97'
         '8ede4b07303e099db49fc700b2df3eed'
         '9f670c7a637f4bc5a02d05f73f76304e'
         '5476342db414e7ef6e3552ea096c5afa'
         '10671af621d3d3e71c0bc6986259ff84'
         'e26d5ae4d808b31832ae93a66fa8033c'
         '94fe13d25f7907795f7651d3e856c231'
         '6ab5f10a0f9ac43078e003bf347ae15c'
         '1030fc08ab6f5c0f268f6aee535ad669'
         '465c6315d633bbe12c445a25c44976f8'
         '528d354d5441a2063c289adfe458f0a5'
         '2701a0cfa475f9ecc5790933c8cff0b6'
         '1381f5f3a080dd70a5c8e1bc0497c70d'
         '92266fa52a1d772027614ead2a69a76f'
         '8d0073e057cd1c27f1098c7a72efbfb2'
         'c3ee9004610063071263b0568f0487cb'
         '50f92dd9ab56028c361f09169d88bdaa'
         '661718cfcc2d7db105b170facde41bfc'
         'e494d00dc8f8a4f52f9b8707dfe6c047'
         '822e8bc454552f2057eb30df13477d0f'
         '4388aae760665c9fb577bbdd1cc39464'
         '6e5663f41d7e5b091ea93820eb6356bd'
         'a7205deabe46ea52b098f6e86b5e0b5d'
         '457d86af8d2a74fd78df3c7e66ed7090'
         'e3b02f18e2be9c730108856c0c3ab4bb'
         '14786a8047e9bf14647ebb8f5255d857'
         '8129d2b62e49aa7b17bd98d00e735423'
         '3b1dc47432b335fcf4d085bbfdba8bca'
         '58bd04ef5abb46f9c948ae4b4a4521f9'
         'e09b86779832cab557fcf5e4dac9cfbe'
         '62c9f5472b293bcd301b52b3645bb339'
         '4b142e98018a49b122e6039de4de1a63'
         'b0be36e36beec807178268cc592c1532'
         'b40b07c3d584ca50a2ede48439e50a13'
         '02f0d0286665a4c032d9cb4dc561fd4f'
         'f42c0cdcecb6be681d70876fa01d6316'
         '9a9a581b3b5846af78eea8909d2c64a6'
         '6272d5eea956396fa58785effc715d89'
         'ab7ee4633f236b00afda122945e00c79'
         '2b286526da9b4f92b0a9e726e46caf2c'
         'c447515f49ac471feb0c2b2e1e50ae42'
         '270280510617be40ca45ca90914b27c1'
         '9bf6e45b306ea596a5c926e3b83627b1'
         '0e80bd0b7ff426afb0324b24f57fd6a4'
         'a7db5c70ead6d4bf8ab4d7e24483ba37'
         '75f16e05207155b2f10c39059d8f9949'
         'c75ac39a4df9e42ba41ae6d4d4ad799e'
         'bcf71d021f79c0b08c419e0b1b1a89ad'
         'c97660465b27d980d520b7494f2e5f23'
         '26658cd027daecbab63dd6273f6f3a2f'
         '742e53c70a38121b8f9479fafa2cab62'
         '2ecbb30f210adcad374935cc3c3d7f5b'
         '2db36ee73a2a5275831cf6b79f3d3350'
         '219a42fd79f56421d9845e4f2add21ef'
         '3f9fea8125ff604e9be2d057333a2ea9'
         'ce84b32f2e2b18c11e600adc9c7ac94a'
         '390bee33ccfff7352d54f8e571069f7d'
         'f7eca6c75a0b613fd1eab400be2c68bc'
         '0382f0284e6b067191b5ea5606c6e16e'
         '4d6bc7ec3c427f74332c15824ec15fb6'
         '2cb08a8ddc8a071cc854031ff0680e42'
         '63307b94ce5a5828d8f730e289273408'
         'c1f157a7cad515d8e8c4c5afb18ce1b5'
         '67b1aae1f04c54142fa99bc0930711ce'
         '48ca8dc9afdd462d8e656920b6b98c8d'
         'fbcbaacdc16db721c06b04bf12e26ee2'
         '2478683e464cd45dfbd9611976c4de28'
         '113d9d0da931bf9991d43ee063684bea'
         '542897a4a81ba4cdd9031842837be035')
