pkgbase="libreoffice-i18n"

_rcver=6.2.1.2
pkgver=6.2.1
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('912587bbeab163b1951266d0a1de2aa1'
         '5274bdc8af8a610755880a17c0292f1b'
         'a826d5b2c829ec8627e67759910db0f1'
         '9f789c627fe846db6a3f3010f5b4349d'
         'dd670ef2a36d1e8d4c195e1baec5c914'
         '1a083e0f0d5aaf6ae665a712d549cb09'
         '79ddd6dd60f721fd13e0210d1c7395e7'
         '1c4e39798c458e227bad2da983c4af38'
         '1d71b7d703f700df20ba98ace5fa8b2a'
         'e61647c1e6cf3de7f53f399de26f8775'
         '22ee5b64e1b4fbafb49523bcdf7083f6'
         '6aae9fbf4ee27d81975673c4b4bcae7c'
         '149a36843f812377184326db6f78dc1a'
         '5a62003c34c65b857512cc5e94e22a8d'
         '3cddaf208eb4c0bfadb5fb96ce136eca'
         'e1d0136d15a9433df001dbb0a1731610'
         'be7ceff3c6fc43a0c1b94bbd345b5a27'
         'aba3fcd8f8202026341a9c70aaaf4418'
         '8b0d7b7548c57ef22a66ccb1d9199cc8'
         '93eded90262e9f0a4b46faa7172e4e90'
         'aa4f13525feb7bbddf44a47e68e21b54'
         'd3d54638fcae7f7f63f0f4653bb300f7'
         'ff65d3da968b56566953746bd7ae2545'
         '09949a0fdeff9219fc30d647388e7ac3'
         'cea4bd7b5e1b5d0debd1c22175418bef'
         '31c0b4bb0eada046b2f227714d2004bd'
         '669366e2c5e8456c91102501ba42677e'
         '8dc429f214e872582d10c48b0f6fec65'
         '65db3b99cc490c59ed44fba92da4cfeb'
         '05c6e1b4d22ec4768b0305fea5dcd320'
         'bc130618db4ba7599eaa08b92ab570e8'
         '75719a00292acfbb185e85671b8e651a'
         '3d1085c367a1e5c80f5fb4a53b55a398'
         '5b6c0cc21c794e4313a67119362b978d'
         '3d128758b26b5ffa72c6e82d1524d654'
         '082ffe0967838de9084b6b873e1f62b1'
         '51b26598876f46e7b5249c9217af78aa'
         '7776a700ca69063b8d6f9b3406d47e80'
         '7efe5c8a208113b6e21b55550f22f9e9'
         '79dfaf0b8119608dae655a7f036c81bd'
         '96c8621a535bbaa4e6e4b85b199ba942'
         '301b415f48ad513c847a27ee522768c4'
         '764dc363bad511b7393a77b954a686df'
         '6d48ede790e89213244e45e3a343e3ff'
         '72b6e3f63af4ed1299fe4b404b238834'
         'b3fc6af7b97d008d6797d2dcb1d96fa7'
         '8834652423672d693c410a0f1dad39c5'
         '918aec493c564cdd0aa9ddb55d028365'
         '7d27e557336661c12cc48d2c7eee6653'
         'ad883c9c16e31ccb49270c2798d7e35e'
         'c5e3507625b13bb8cfbc9b58567f3c0d'
         'ddf4e3cf9d33b20c5538a4d5bf1bd2bf'
         'fa21d69449297b95975077e4d317c1dc'
         'd93d62aa413847b181d634370d83fd4c'
         '8fb9497becfca3b7cabfce0588652d02'
         'b4a534953ed068803dee1ee03ebbd994'
         '043cadf3520867629692037cc5d1169a'
         'e82f2807f25dc2947d0a6c16a71b72ed'
         'd59e037228c5847954a7d70d2512e688'
         'a3d6f713444f27008d76dc4aa12c0c6d'
         'efb805712922a095c6e7380e3011fa41'
         'd1de73486e2c0be4cca703330e709fad'
         '24efd3db4b7b309766c856c5197c35b6'
         '859c643c9ddd5ef5f4e65ee6f0107684'
         '2bd7579515e5622bb717ee053260319c'
         'c91462d6510b4af49f48e38c1aa65bec'
         '2ff171d388634f7ebabdde7ef12001ea'
         '5569970755c87a69485f04b072828f2e'
         '682166f3c1cf19e91731f53ee3957284'
         '2c15d8f36346766d00ddff7276773903'
         '9c4114832daf90fb6033586d7aa336d2'
         '7926ce92ac3a0537b8b8c96e9d3cb5ef'
         'c58041097966cda0515268d31516171a'
         'fa2391bc019cbf589e19a8f46a47e2bc'
         '41ba050a478833a00c6965b3cfb12728'
         '2c97f484478796ecde5f303859150d9e'
         'f04981450823138e36a5206945d43c88'
         '23384ac6bc09be564ff1eb3a8c7caae9'
         '91cc7f1db9387c1765f7e20ce449e31f'
         '8ae0919077666ae1840900c96233aa24'
         'd8f4db3bb2e59a823971d40d4da1a9f8'
         'c87d20b7e40fe9d91a1b13b7a14bbe33'
         '946b1e413385acb5093a6297930d1bec'
         '0d75489af1b41d7213c204513151582a'
         '14a706c754f3de51843b89e85d7fa907'
         '6d4f117d951ded399e4b49bd71cb6d6e'
         'c2143046e976399259ddd681a96ec7b7'
         '2b2d4d96ac480f35d24ad9f87f367884'
         'df1a000980ba0aeaa3dafdbd723d0d36'
         'f6bb69f9cb6e79becbfb4ebc62e794b2'
         'b4e273ce7f424734019726826b5930ad'
         'a07bec2379dc5d55dac57fe9c1a280fc'
         '602c1d147a1f5712ee8812e2f2f00ac9'
         '7c99c548d6a1ff94226313a70924db2f'
         '73c82e0a50b9dbc64149b8cad29c67be'
         '85aa8ce6ac6f5c3ae702ddf5d8a5f55f'
         '373d9c2a240b801964828698a6994435'
         'c092b904bf0953b74b858085194c9b20'
         'e3a410505947cb9adf93fc2e29a8b1ba'
         '6a9ab400eb44632f82d04bfe15ad2d75'
         '49ca7c5923c4c4f20af021a78d0798da'
         '1281af09392b8d990ac7f65767b4aa4d'
         '3c710f25da7da633fdabe62867b86235'
         '25ddc9c5b31f735b4485d44117d03fe7'
         '6bc55c7c02e9b0f3ddeccf179d337f60'
         '4511c4075dff128c1b04acb0bd1d9eed'
         'e3cc1fabbd131356eeda81463b5b2cb7'
         '9a0bf0204f477176758a6a6dc7d144ea'
         '45f03e0e6cfeefabc65a6792ffcb6636'
         '4eb70e113a9bf71725769140af8fe8c5'
         '312f29ce9379a4741a0b62920898c9ef'
         '4ca2c928d4372b6dcd31a533fcac8b0d'
         '77aff56f6937345f3e096360a86e9cc8'
         '69c2a0a27f43a8f7b7ade312095d9185'
         '38fa053b6f0befc54ece562b8ed70f88'
         'c82f3471bd76399e2ef2085f818a114b'
         '78a46d086a90882022b0cb24debb09be'
         '5de22566cc4b1e9b585010dd05d73d80'
         '20e7330f262e46db1592420e4955be18'
         '3f5b76ffd3ccecc4e5222bffe918753d'
         'be9e19ee01bc356e34f804ce4a7d740a'
         '2c071f50485e2b61961e66b405658b1e'
         'eb4ed730e5af8a929992ac7a845bb8be'
         '56044b434f025bcb450d0b2014a5ca40'
         '81ad7d260fea30017c2301760bfd3c9a'
         'c920d87f924aad696d8c321d709e5b2b'
         '213ee1f9504710c5bbaab40b8bdfc8d5'
         'd49ae86905b9794b9654aedb1151b101'
         'c49b1009ebe2039cfc6c4904f158344e'
         'dac859d3dd7a20072bc630325ccf118e'
         '326a97367f856b661275d3ef9d67c2ba'
         '6e18c78128943016ef79a9c04bd1aec8'
         'a2f4bbf8f48a6204344096115c3c2898'
         '2051fe4647a954b1fabf387dfa5a8b66'
         'c619125893e313c98a98d2a8e881293c'
         '15f199c00fe99a706a2052337638cb72'
         '4195efdb98097ddf118b32d70f909ebc'
         'fef465a3b24d587980e1b576d46e9120'
         '4e910928be9d9cc53a934051605b2b43'
         '2629d43f55812087ca18975e36eee02d'
         'd60aa0a52ec8b9909fde4b2d5d8e1203'
         '23817e6819adc55d5bd313b7ee820b5e'
         '650a9b0e0cb0d06617b4f933b4590e07'
         'acf1cfcfcff5f178a4f3991e257a767d'
         '0d1ff0763e4d7d21b340993e5f676ffa'
         '1cc9c0fb92d84b39a525c21388d7b96b'
         '58ea2cb7ea221f507010053c9e78f373'
         '3087e29d6256e75b4d701a272f882bbe'
         'eeed32dfbed9b537d595695828ff0cc3'
         'cd0514f65d76501f19af8a5e0232720c'
         '54c4dfc439da5c55a2bdbdd9b7610b91'
         '38030bdfd52c852d517071962e1a751d'
         '9adffdd55a302ab5926fbb788f261639'
         'f4b53538470a2ce658dc813ebc11d2b7'
         'c52d55f5eb5d6b272e50192ceeca8fff'
         'bd49ac6bcac56a79210c9dca9f71a87e'
         'f2267f535a3e02d31fb8a08e5174b25c'
         'f3dbbfa8e65921a1cc6e8ea32bfc80a2'
         '3dfc861b0829896f46a0c3dbde238a6c'
         '1286d48a7fa315ebdd2739ba032e6be7'
         '9d01f183d7c658475a1ecef38fc0fc0f'
         'c3b3e093896f59dc6420b14f40b8a10b'
         '93ccf6c078bcef7ff6d1c4c126f5fb2c'
         '3b2455679bba3924e37341185f8ce92b'
         '8ce0de8a444ca97ddd5c255fe99513bf'
         'a7028e50cf15638c55d8a1e0dcd8183d'
         'd5b88e4eb5618b0be9c15f33816b91c0'
         '330c6fc5ad5c3303540f487baa044351'
         '0a8ee532557e4ef368b64335114c9765'
         'b773ff2c8a419a96abdb1e226b5dfa7d'
         '5f2962a75609cb2569f792817411442f'
         '1ad831722ee590b40556fc6531a826fd'
         'e38b34e2063003a5b707ac4255bbfcb2'
         '6284704d519b9d31a1c41c3fac851f42'
         '836ae63ba5be4ab2d875759ac1772137'
         '3370f066a1e21ec5883dceee63b734cd'
         'ce70d161534850f18fbbf4471aebbab7'
         '2c51ed712e1e7dc86b47d7f21925e30e'
         '2f849ee9a6b43bb2bb34976de4525cf7')
