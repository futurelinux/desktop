pkgbase="libreoffice-i18n"

_rcver=6.2.4.2
pkgver=6.2.4
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('d75bf59d086e560dbcce0ca62ed37cb3'
         '28fcead4aa643a0bfbcc116a74158e65'
         '6a6baae6c8c4d9509a75291ad3a43992'
         'b355a4e754574e1b84df939d4fbde05d'
         '697ce3df7ae97028ba0318416adfe1d7'
         'bb79a579b7704ae3a2417d594b684120'
         '066505481c556debc4bd468f53235db1'
         'efba53785710a0b50282bacb25ea169b'
         'd9fb7bb9ec9f61d37506afe651caa63a'
         '931948565a2091560c3f0112b52a3b57'
         'd30d950319f24ccfd7ebbd5f73bc42f2'
         'fa5682393f3f3f51f77faea0b9b31c1b'
         '90c8eb41bc4ab7826a33a9fd0f85cb4b'
         '298ac4361dc0f7a403fa1741a4b0b34b'
         'd1c0f9b54034e8e7570a66992941fc7a'
         '0817fdd320ab40804104acb00c1d459c'
         '44b719718c73a86cf4bb2cab3a2b9bbf'
         '94d2f1aa35915ec65df0cac1b1a6ee31'
         '50e589d3330b6680bd96ba9a4442ae51'
         '71380780947fa9654df83c9f370b1079'
         '82a05de77db82d7935fbaa4b325b9884'
         '9f62ff570a5483c6c96bbb2689e820d7'
         '80f8627f7bc89586c532b75854eb0314'
         '373bb11a0ff8fda68a61430418dde5e1'
         'f5407edc5d8beade546cf15b57960d57'
         'a00e0e50646f546abad15ad654122a28'
         'e9463af81420e23e9ab27be212b5c345'
         'bbf3b4137a287ae535e7b127de46833d'
         '41500d5483ff7274a70699d58aff4224'
         '07aea91e70f23c1081ed86f8e6183bdb'
         '53e2064b27aca040d15e05f985a3654c'
         'cb5b36f3887aeeaf0350383f30bd8f10'
         '11084fc8553c27b7123865e80600abda'
         '18bee72e46e9fc3ee37b6c7360bc283c'
         'd98b7fdb99f30a69314192c262c82bef'
         '490264d4f8f9d95b0f698d06f6e20fb3'
         'ebd22884f16216fd3b80933f87dd4e32'
         '7e8ee5ed2ee0141fecf2c9e4109f7699'
         '2f59d62046864c0bdd8949190e719392'
         '81aff7e2dffc1618968db7142ca0fac9'
         '388fbd9e36d5700402cfd9bab67aa0f8'
         'e71c80a3a15e7d444fe644ed07fd2c91'
         'fdfbc1e43a129cc2378694d7533db1f9'
         'd420a19c66dd622ac6b247d1eecba366'
         'bb0af8b9b10a31be89c082c6aa09c2ca'
         '7c9252ca16dcbb4e7b2377440f15db7a'
         '2d4f0aa436198be6e689d01cafc9fc03'
         '2d1af5059e33d5307fa9e14159d9eb92'
         'c9b2fdb2e6f1b360cab2f13df9402ff3'
         'e1a14304b7f8670168b86b6fd4becd56'
         'dda3a00ea726d93bf0a4845d7e15b473'
         '4b4d7b3ceb2f4446a5bf80f6152c3740'
         'e64636dc169fd73d7ffc86ac8ce42c33'
         '04469ff60838f4a6fc25283d6efc008f'
         '963d09b0aebf5d505f51c2dd076148f9'
         '37b706ea9bf78fa414b559cea9906c87'
         'd5775493b35c845692b6608f3a194ec9'
         '271cb8e046c6f899ab29f26926fc2f4f'
         '37effc9b3fd9040cf8da08340fc5c0ef'
         '391863905d8ef6ba62cc396577b5127a'
         'c5ba137c52b0fed16ae06ba87b362436'
         '5c9bc492e5693dbfca6e266e692593c6'
         'aabca63d8d090a6714b2515c336cff56'
         '2a40b2cc11a16fd99b187d61f29c304f'
         '05615c32a77a4b3f0aa41201bba5a8c0'
         '3b3e4f65c2070bf025a697c3e73efe64'
         'fa50615392384db376d551abd67c53c5'
         '677699ea964b1b1d7076ef0d2ffc092f'
         'ebb2656bf4f3352106a23bb3e16d83a3'
         '52bedc50702c6087715c824e681bf00b'
         'cf98de609d274cdb7575ae867415ce87'
         'cc56c93ac8a8ac7214bb214520862df6'
         '174a6847b437ceae756cb2355a7f0e58'
         '1e020935e9af029c693e53a544eb2a01'
         'fdd7222a27f3c590fc8c6f3c1e7183f1'
         'c549107a91795c0c9e28c2568f5293bb'
         '3b23d1bf081834b3cf93f6b3103e8e4f'
         '469370b76681c78231dc704acc648768'
         '3068f100efe6268ff3d197864222c7d3'
         'ffef1db42fe64704101084e3d0cab80e'
         'f94bbfe0120747ac44c9f5b0acd43a8c'
         '3502d97a4e4a00c95ba3e92ac52e4068'
         '0bad114871e831970fcc378215c19c47'
         'ac53764b2e4eec795b3fdac5002075f7'
         '2b40b26848e02e119be8a10b959b5578'
         'b6c5bbf83f4480c80762f34332c78230'
         '3b9eed109e4a26d8bb7d73badfa5ad69'
         'ed6593670686d949a74b111b6d2d4ab3'
         'b70b0d869a92d01276c793c987c5b896'
         '8af56d4b582a8ac98b6b3ce6030eb8da'
         '00f3b713f029c921ad04cc7076dc3140'
         '58de3aa2efc63cf221253941c5b76cec'
         '851df73ef4b6d48a5240ef2dc1049195'
         '84fe9a6f220b5e6d7bd4e0f01651043e'
         '5222229d6eb201a9fe0ae95d4ca2ae28'
         '8e4019ccabbb8ec3d2baa2266938c947'
         '23e6ae250fc842b0daa8e211225ab6e2'
         'abc086c843be3f00f182d5987c294432'
         '9f12b4da4e4cc3632758a31317207247'
         'ad5568e70c2351bd01433269689c11d6'
         'e2319f43a1e13d8847cc1a53c0b4da99'
         'e1e5303a4ae1b10e4ab224575dc1b8a0'
         '85e02d39c7683ce0bf98d3ae5731f339'
         'a6ba0ad187ee9dcb472bb384ee78e9ad'
         '313d633660c1a0a66b2259b51a42986e'
         'b3238436966935f123d104e7e7715654'
         'febd96138c15a8085cf19ded3f8cf607'
         'ad2e110d5469a86457065c9d2df6b4ad'
         '757624aa8f991ee55698cf386ca041db'
         '6bfcfe5b115c9ea5d1eb1fc9f7944179'
         '8e699af4dcbdad7fb831f5db80e58f43'
         '441055ed9e01caf0bfa73180c018aea9'
         '99198059f47a217a3edb73e27ba75312'
         '2461c12a84266e815e7327ae0b5a88b7'
         'cdbf4dd7be3c4adb7fe61c2fd6207c75'
         '9e2e5eb9d300e6c6a76306a9f33e6f60'
         '38248341b3df1dd78fd0773b77796707'
         'd268246d269058eff4e316899d69a313'
         '5b41a11f73fe6003a7236cf8591dfea4'
         '271edaf07c95abdeee105767c38d7ad9'
         'f820fef896c6c7f98b8356474f57984f'
         '2358850b2c719433b77fefa4c224918d'
         'fb9ee0d5be07831850f50c29bc7511ac'
         '54b5d70d42a52078d716395f4f3d3823'
         'ba8264d79ec71dc5364ce9fc1b091d53'
         '43fb91da7e0ee0d4760d8c7db03d7d65'
         'c2570e386eb442d75ca7f60c33528a30'
         'd2c51fd1b7950ca1e2c43cce06d9e310'
         '65095a4351639237690ec82a01960f02'
         '9845022f1ce0e2ede8f99467bbe00b28'
         '8463eea2276f6eea99ced8a539821182'
         '903d3f24814b56bd755fa32811cd0d24'
         'c5553f1a7f901c80d05e40b5935d1139'
         'f4b5b7a8195c9bec39d402a99063e64d'
         '6877f4f692ab0c81d23f6fcfaf88351b'
         '9a5a922f7e4891e56f1d3f393a1e095d'
         '43dfe3efcc345d541be357a50d98c8f4'
         '2f6f442e2b58efd4fb0315a3a4fec8bf'
         '8177b98e5947b021cdef73ac08366229'
         '2ca4593fdbea550cfa8988604f7e92ba'
         '9c7056446a7b0cad95a4b37066641957'
         '5f89f1fa080f3f3549da9d8c8b639f7b'
         '38f5cada237e5c45f2c85856b840f95b'
         'd23303567ecdfcc19d849c6083774afa'
         '2c6cfb543171d45a11b416752fd33202'
         '26d3c1f00095b82c566917a2b563f068'
         '6762a5675c149c3848dbfd55fc1f2bd5'
         '07791cd4a190f6f8b9c03ef974bb93db'
         '2aeba85583364d462aa0d27c23ba2ea4'
         '8bcfff2646a00f64eba70247f7ebb971'
         '397e30e26b318485d018ce415453e24b'
         '6db820e17f552cb25ee94bc2efa0635d'
         'c1e8bf0a90480baa0d469d64e2f058e6'
         '03ca740c3da7d8cbc81085048b1953bf'
         'c923ce5ecf6022e3dec7226cf84b05f2'
         'dbf10fb9a9e9c1b79faeff0e6e3eddc3'
         'eabd58bec86d5456176a81b0937b6f9a'
         '97438656e36ceb4769e9274c182e6949'
         '374f7a647100b882597b2a842c5befa2'
         'b590da3dbce18f61d0299a5c3a8efe2c'
         '3fd36e4cc37aab8367b4be1d0c48be2e'
         'd7bac748ba7f7893929ca25001c0cf25'
         'afd4cc3ee2d049e3d611852565349052'
         'e64953fc4e799ac5399873e7d594260f'
         'ef6e0617cd12af571fbd9c685ca62c47'
         '34a3149d394017fd5e6fbc6885353f66'
         '2637a28e0221c7b1f1f3e417dcab2c1b'
         'aaab239de72dd595886516f59662beac'
         '07c79ee561c2a4d39b022c423221ca31'
         '0cda00715010347000c25817077ca524'
         '2a1078e4ef4d3c45078b1e3db12dab45'
         'a8e170998e424c93ef8c63b489de2498'
         '725a049b6e64cbbd2086ee6dfb142a0e'
         'ad641b4e1b699af7156ff50a82c28e24'
         '1fae63e3cef7268a853aeb345fc8fb8e'
         '55a9dea66b7d2557ce3876af55d85c34'
         '9c98f9cefa16e8e1d2bd6d4de578431e'
         '8e21bed8a4b808a332a74dfb565c1d73'
         '50c33fe14f033a4d957c605a3b337558')
