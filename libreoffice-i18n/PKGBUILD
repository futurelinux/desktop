pkgbase="libreoffice-i18n"

_rcver=6.3.0.4
pkgver=6.3.0
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('34ae0ddd591a56f4c0fc2e1e5458ec60'
         'f2f059f03059f89699682dd16f96c632'
         '5e685174de5ae467c9bb40bd7b3b19d2'
         '1ee0528eeb8a516e6bf9d4f1e6e306a4'
         '06aa884a9fc35024f702e78feb5d52c1'
         'f22f12ffc637114387b05e477a0ca44a'
         '330c5a30524b7fadfd997770068cf296'
         'c4cb4d1e7f85285655fbe20f4272287a'
         'b39df22f3c15dce07e9f90f490e57871'
         'c020c415679b6d110ecb435a4f6d3fd3'
         'be150138d2dde98c2a87a5c5ba74e96b'
         'f16989937099efcc980f8cd82a928858'
         'fa4470efcfaa75274f184f3657707f4d'
         '5d3b4caea75c9eeb2545fab369f03baf'
         '820e3546ab89cb22ef6e65686d89a252'
         '8cd3e71617c42efb8578472d341d74ec'
         '689983fcd237a149e89b1740032b7113'
         'd7b8e6402b0a158059b59f9687b8a2f8'
         '371571da55a9688b7836e3fb1b974794'
         '786d027477bc01871f0039de001a8c80'
         'f9d26b91bcc24ebfa81a948bb4c78090'
         'd08c6184c300f53f80e20a26f8f0ef15'
         'af1ec1ed89766f9460c83f909dce8b26'
         'b063818b9cd94aef434fb580afd1bfa4'
         '8d8ffaf916b3e49c2a27e37ce453572f'
         'ba895bc0118b0c2b12cac5ddfad9f512'
         'f60b3dea15bfd4fa4d178351912b63b4'
         '4707fd5ad892c91fd0462a88955775c0'
         '1e16df5953cf791080ddc4028334845a'
         '827de73b42601a6df030e15ad1a23c27'
         '903c445dec0aeb2d76373c2d332318fd'
         '83691babc4a85d353da5b8895cc9e352'
         '16dd00cba36c0377d8d739728373dfd0'
         '63cce8d72e1e083657bad42a637f3b1e'
         '35099c195b204f7475cd65a73d2a3c0a'
         '4771628e510d6fb65aeaf3f1dcba9020'
         '968bb644b1e07ad8a9c8764cb2b05666'
         '0bea5c84d9394d9fa37b9317c6d96b00'
         '12a2e3ebf23c25dbc2b4d0ba0a17298e'
         '33b4bf5be0e2326d58c137daa7f4f3b8'
         'ebc7dfd00c8110c576ac60580a1108c8'
         '3693125a38d05e7adfc3e1e11c35160b'
         'f63575068b7399a6a7f2f43ada307e4b'
         '397d1883c637bfb9d3c2ac1d92becc16'
         '002d7cbf686cba33118beed0ff732335'
         '7b9859614df308623f4ecbfb7189b8df'
         '011ce1562fb3abfcb0195794cf8476bd'
         '8c9963cf4a9ebee3a32e443dbd5d07a2'
         '8db4bdff133c44149320557112d5bcab'
         'c89fdfe7d0fab024705d55dfff5bd905'
         '43536498bfa445ca1fefc19e4cbc87ac'
         '73dd1f4a90a2f38529563cf21faad5be'
         '2aaec299ea100d85e66d1be435385f99'
         'ebdd6248385a05ed7ae7bea7ccf1d571'
         '278194713f7769e54a1ca92904bbb09c'
         '1da964ce0221519fc88f394a4c325689'
         '938c2f5788e4a85f391236a9bbb84f76'
         '5080de787d6dcfc5de024b8bcebee847'
         'dc687b91de99a5209360f5d0976e4f69'
         '886c41f4d8001bc3a895f33d03ac058a'
         'b30ee7e1dd11d6c9637299e00571c194'
         '67ee195355e68cf91aa4cce6d8d12096'
         '835da239c66b310d0e3df132fc96517d'
         '946e168383942dc85ab6a9bb37f9c814'
         'f268f40add779779604769880613b37b'
         '797b1546e311163d3a6a433219509480'
         'b3f5f23627d88f6382c3cd9c10ab84d0'
         '300d8692b3bf8c17119c69018081128f'
         '815dcc3ccf9550b4ca8c1318fc884999'
         '22c5c504e6962807ad3fcf01f72f9352'
         '7d25cb7616068234ce86c792b02fb0f6'
         'e5020c2fa964ce8b27223317f5925f3d'
         '7f7963d3663e06efb65a685616725524'
         'd09fa16670d6e34cbb2761b705e1a1fe'
         '654a89ead1f2930278fc4435accf1a6a'
         'd63c29675b26c5fd4164f3b798961212'
         '24521714cbaf598b2a6a71be24d1d0b2'
         '330ce8592e4ded6d0982012c26028568'
         '45d6fe63b4e34f180631cd0c1122cd9b'
         '80b5fc91ba235db78fb6888655d95f9c'
         'bed2229e4491043429aaa533b8c54570'
         'cab59aca5d1584698cbbd551dc4e53c5'
         'b6f89c61fca0e3ae37c6a9c6e8e6f337'
         'eab9613b25d6c5bf651e5fbc81d041eb'
         '9382fead55d74f0bcbcaf27e03d6a3f8'
         'db86eaf77cfe6ea88c0552e1f98edd5e'
         '8eaa4dced941316a767055f5128cd7ee'
         '155410ceea15dc233d55c4cce21a0c93'
         'af60ca9e508bf0025b9ebe223959c15b'
         '9eca5a27ff0da96bc0d9b4bf5ee4c387'
         '0bb57b6f7954f6d0238738600f7a87d3'
         'd96c68d630c718fc00c7fbb607410361'
         '3b47ab23c9445db14730642fff191f02'
         'd52ad0712223dad64c8058b8bbfc2b5f'
         'd64704b4071a550c06965724e1901d35'
         'a664f49a8a65861e2a288c36c4f0b7f3'
         '126a003b841e4a1c10a16eb921c64964'
         'af10add35547dfc7fc1202c4e7dd7323'
         '56899a0ab2489914dcd338e0bc7c6a51'
         '719519164872990a45edbe2b8e067b3f'
         '9e20d76ad011b3c4d33c2ad8aeed73e3'
         '3054d43adf12d86a166bf2fc1ee9a2c6'
         '84c35ff6d2dfbc67ff5eab6e76e29258'
         '28a50d93fa3e6b8100d8bef36815d36c'
         '9920f6f1eb88059a30e905b7d00283c9'
         '18d146be4108a78a863f0e3714d19dc6'
         '5e79688dfe4710e0e7af84a1f9a2316b'
         'dd8d5fde29f23127037b47cf22b1dc27'
         '75c2e81806a34dba5e3e4da26a0a88c5'
         '4887761c90c4fe362690a720925633c6'
         '7d560cfb4ededcd924779adab0d7f3f8'
         '3580729400734fefc87685eb1159ce7c'
         '1b32a67b6dd002753db23bea7a1e8c95'
         '4c5b2d71d8977ba3db63e7e6c3ad4d51'
         '65e63bbb43cdf30086d43cde354ae935'
         'bf911af92c72c5987ee4de2645cbcd00'
         '8ae5093e0e8031f7abd97f223001ec68'
         'acf0e2d524009fed40ed8e5fd90454bc'
         'ac5d1199595b76f59a9edd3ec6776abc'
         '5d3d53a52940f79c295d18cd3043e0e8'
         '678f165fbfdb0007010446a0a87fea18'
         '065ceb68dcf47fdfcdcef5bcf4945943'
         '45e7b3a05582b05d21c272ff8a9b3b5c'
         'cd977020ccb12da532f052129886ead6'
         '5124e15f27e74739d037ff067f7abcd4'
         '07f35a96cb3ad0b352b5e1616c816045'
         'ca408ba6adf98001b67dc443375175fb'
         'ba246f6e75398e0cf1b080c8ae220b8d'
         '52648c7c68882b1d4ef72e5d68736c1b'
         '1e2432debeabc5ab7a890d4186f6d7a7'
         'cd211431ff6a95395ed49ef066af00b0'
         '57852c529f41d9fcdba41efbeabb8f12'
         '17bc2027a4f4e8b7b2efaa0a740d9c37'
         '1f2f25aca6d00cb94c20cb5af4314e79'
         '44db935f176560e10bf60c86caf3302c'
         '5d6688e2093abfd8cd2de56633bde924'
         '3937293f0f3350144f7430489ce1a469'
         '53539e413110b76d2ddfc2a7312570ea'
         'f50e9f07db9749f5c9137bba66f41fa5'
         'f2b7d917e9803575fb6797b61475d036'
         '85b9aa7ea575f7fbedeeae296be3778e'
         '7018b92d4024c4724e067100821fd94a'
         '1f358c7b08325c85a3bfaf48cdab097d'
         'b3758c9e8364cb804a4b7365470cbe8b'
         '83e75a4b9c19c90ec46c7d8932743989'
         '7342a8107166ec74c11e62f404bde71a'
         '9e78637912491434770d8bc891ff4a5e'
         '3233d9b76cdaf87fc45a2fd47268318b'
         'e1d3a2ca84b35f7df18c83938b5c1ff4'
         'a0902596b62f3b2f442d8f3bd347d8a9'
         '4efa3be61ca483f9b888131058c82f9e'
         'e4d5fc6d2bd942bee5c01dbd60f5c15c'
         '2437e63b9486280b283b94f409c1133f'
         '382ef4e5d183c445c10e4cca2c848112'
         '17cdc912839558119c83b712ea301fae'
         '866773c0793c55be8c18c4a4747147d5'
         '1ecf4629aa527332e513c7f90a806242'
         'db66eb603f8a749845edf0b46d34867b'
         '31ab45b38ebb8e72e4c95a038303b0a0'
         '0812a8f16e1508f19db9c60548d32aaf'
         '8ade34006d8b297093bcae2e5369c9d2'
         '6ea94d105ccdfccf7b385509a07c706c'
         '9765b635a6a85334b06979a0676e891f'
         '2d09bb5d72757c57be0d28eab90a5303'
         'bf3094c228057c7f70edd7fb268dd032'
         '5991c3efefb2a2857fcd3b509c2bb34a'
         'a00909bf6a3e357f0269b85ba201cc5e'
         'e539202d43adeeab6b5ef663a0dd899c'
         'c7da8118fe8fd294757155678b9e1034'
         '58f88a5e5bf24a7b353ad2ca542c2900'
         '38d3acf0c3ff7d81b07eec8d41ae50ed'
         '080efa1880e84b2fbd6aa543c0b0df5a'
         'fb7244a670b9c8cff722cb009f586d5a'
         '8e4dd67195a68f37d20b0b78a9c411cc'
         '5fe797eeb6b02cf80e301f5678de9d8d'
         'e6816424a840cae4404aa64f2807b1f5'
         'ab39d2b4666cc026815ce86d2cd4c185'
         '90aa9b8efe3dc372eca7cf77139718cd'
         'c3077547af6d8fba23b0fc2473c5e392')
