pkgbase="libreoffice-i18n"

_rcver=6.2.3.2
pkgver=6.2.3
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('ef1412626e821db8e4dd6fb63665241d'
         '58f7caa8819a7f1364c0898b4c30e3d0'
         '9c1a0dd9ed91ae9d0f32504cd4085ac9'
         'e67c29f9f72279393317421d79f94b5e'
         '4342e1a39407278872797a204c045ccc'
         '45deb48a097f846f8e22e1cc8188fc19'
         'b870541bafe24ce20a18c76338a4d160'
         'a2ac772dd862605e75ab09e2c4aacfd0'
         'c809b7a87f8b9445d4eb72c2b72e9cb2'
         '2ac3a24f0a8b23f17f155842d455a279'
         '066411629e9b60fb4c265cfa6dce402d'
         '734a2f0f12a04b91fda05097e4710edf'
         'fac615d09b902a3805729ee8c5bdfbbb'
         '8be3752a423dd73ff50672c8c7467709'
         'b6f4b7755fa1681b3c057e1d1127ff68'
         'cbadeee0be0449cdc8ea2bc76152dc60'
         '5cea46100e9613236c4b8e667d00ce98'
         'd00e16f2a41cf2c63825b29f38c2bb3b'
         '07024b11807701f87b2b85e40d024a2d'
         '7313c32e306f5c17183bcf6b82231bae'
         'e585067278fce542db5b055fdf1a426d'
         'af6ebf986f85caf43a9e36a1f421be22'
         'c7e3561062e46300535c3fe9bb03d342'
         'd33ea8d856f2088c567a05dddb3b59d6'
         '1e0c141b1e177d012693da00a8161cd9'
         '762a6badeee660b25c9db9a38740c652'
         '794d23a70ef20aa92e79420394266086'
         'b7f26f216d0463fd8cbd5ab991b55eff'
         '5ab0adc32ca14658b389db96b93c7a64'
         'b23c8f0b72440fb9c18501fd59ef6cc1'
         'ee4251c438c8748d30027c4027f7f5a0'
         '246f5fc4600a49a906355951b6303ab7'
         'b6b9b5391c18ec5cb2a534f61d75bb7b'
         'e3cb13cfe04b76303d61fe797f3b6682'
         '6f2131605809bb71290c399ecf6df83b'
         '14ab01efa674b7980dad901c19be66f1'
         '79d07adaf0b7ebd29e5a3a700a676de4'
         'c2197b96272318bcea59d65349048f9c'
         '3aacb2aacbb62ca2f816a8d634280d36'
         '4d36d1bb7515ed7a8d0c083f7bf70200'
         '7bf1983dd9d88b557e8c54e9055711b7'
         '020b9b50f7465a478e09a39f1abcaffd'
         '498ff69a6d50da90cd039b0a09a73ff4'
         '2a309f1d2d9897cd4ddbc19bae51d905'
         '8e9da6f1184c9ff394a8a28b918190d1'
         'c216b29a5459ba6298c730820d73e1b3'
         '78d2cf880065b00e49ab84757c1abe9a'
         '9048a30134398cd790ae4094f9ce547c'
         'c0e3538ca87e1503a2a010d4345128ab'
         'd34046d128a94e57c58d8384586c3e20'
         'af738f68b10a1de39693b4d6d6634193'
         'f9aae2b6dbe9651fe196b1ccf76ec901'
         '5906a68431f8bd0e7aa1d971bb143f9f'
         'e8bd9edc24c927120391b454ed161752'
         'd92bad6e11680310cebdd8d53892c8ba'
         '965bf95934bd561891594baf1e942306'
         'ac64717fddc6e8c63176165cad506216'
         '0a105314008c4cb61eb2413533185725'
         'd4c1880ac04ede4b642e671da2685c93'
         '091221e9d35ebc87b7987c4108541d03'
         'a308eae1e5ef646b0226607615aec86a'
         '6b2efad75e62da2c1b886f26d478fea6'
         'cdab963bfca6436bf15e40c264c10019'
         '872ec0c717b8b7399748434de10b22d4'
         'c7d2439cc64d84f95ef81a78b0d259ab'
         'ebbdf743eefd8259463a91700c28ae0f'
         'ab0f69aa70919c51e97995b3bbb561a6'
         '2a8d54c853c34b3a9a4cb4cf3848a621'
         'fd802e59ad35f4b250d434d36cfa2fd7'
         '08ab409c6960bbddbd30524bbcc91d3f'
         'e38451e69de995005ece136630492c5f'
         'd6c4228c0adc2f044da23b6b92d15d46'
         '38aafce6a36914af5675a89f8ece0db3'
         'ad34f37f89b8b768183156a4041d9a78'
         'e8801cc8148b9e0c6bfbf7957ae136b4'
         '9d7cb9cc03da2c27dadd8219487d4ba4'
         '5428006b279ebccc8c388f58de4c9c44'
         '2283115c9a486e0a69d438ca2196e1a1'
         'bbdc62adc927b5577e1bb31800ebf291'
         '5faae5fe1a60519a6086b7eee1766fb9'
         'd148bb8d5e9ea73c795622afe696f69d'
         '0290f4ce8131246dafc0caccf6799683'
         '60038ede09e20f9e39be16cbe1f22255'
         '814ca9e0b21ba76765374bb7c0d9be40'
         '85a3d7a895ba930a71e0483c227b678f'
         'a39e71116890c60e23dfac571aa5ff81'
         '740c5426be6e31b366ab808b720835dc'
         'fd7cf447ff4754cb321a0e02e3bc4d06'
         '629f66b674b9c7ec602563a8219ab160'
         '1efd75d3dc4716d7cdc5b51cdb399079'
         '80fc8bf0803647f5236d24907ecae46a'
         '41f6d5a4e417c453b4cd3f240a2476ea'
         '0c7030cd547225bc5ce7a2bbaacdc13a'
         'f27fb23e46ea0180e61d23d80da5ab7c'
         'c3fccb665dedff963467b5379fba28fa'
         '090812fdf597717e5d3ad0a61bbaad47'
         '93e209ede637d7697e718c39723549b4'
         '58cbb829c31af559f95087fee37e094d'
         '5ff8f3a8c9e77b961a459de33f7d1572'
         'b4a97156fe275ded692d4b6a6104f1fa'
         'd0411d577797cf5f1b9d64c4eeb5a3c0'
         '8e0e2e23250bfe96c731feb84b545336'
         '57e196a6f3124c41528fc90b193a2ad1'
         'f8384c7ddb6420878df29e0b4d5b5990'
         '4b996a37ef400ebfae153b472a33eb74'
         '159be1e9c48b48b495fa1cbca6b3e5f7'
         '397b291660aee623c790848c382a813f'
         '64c72222cb0ea706892b21a4f1c15265'
         '26f7b26e4c23badc19791f3bf31e2764'
         '4b73553f77ce74a920f49899b9b3f681'
         '7d5f331cd9924e6e56d03f45add049b9'
         '494badf4377182ab6739973fde7f9b4e'
         'aadb14e7fc4f67cf5830592a8c0f2640'
         '301836d27619528f6b2ea8a44c0d3810'
         'dab577bd1d491a822b41aa8e6ce0b305'
         '1ad8cb21bb4381c9e0ee89ce8495db0f'
         'b36b8bd96dc4dc1df41c0b41e20ce28d'
         '0acaac91da00c5266fb59d8a6b06ec10'
         'ccc0eb32196ee78308dfb5e500adecc7'
         '166a7c1e5259d8b2da1fe5cafeb73c87'
         '622af9177b2d68c7264afcfde896c2e9'
         '3adec767e526e3f040ff9bc72bf6d602'
         '5f91aaf51387555277d93f891a82edad'
         '247b095a0900552bd5ea7001274b2b96'
         '60a758dac559efe1e13748e6640575d9'
         '8354653e6c97e14af6a68130b46766f3'
         '0c289360fd68bcb840e743a0a660d3b4'
         '6014dcd227fa2d83687f19f28ff0bbcd'
         '481d951ca6cf71b94fc6a1a53a4de832'
         '9e175a81c53dd245b6427f2ed89e0de2'
         '0e6153d1bd7a8fe1d98bc238c0bc55b6'
         '4cd04a97fe0896fd9839d991158a6cae'
         'b3ae3c03796a572c4634d07b4b95285a'
         '47f3c46014a72667f3d1161d6fcd77cc'
         '18f165040b4e9df1077669f48e0e45d4'
         '63005e3fc1cdc11b5746a18af02839cb'
         '1f2e5a952f65109a3159dbd52636720b'
         '964847040ab26e71b1ef1da675ea0b8a'
         'd29b09beffb5333f1bca4f5fb22b68f5'
         '5080981d83d70d1283222e04d3aedca7'
         '6900a54c540e4714d855e1993d0b210e'
         '6228f7b50fc8e39f729f17a4b581bbf1'
         '3a85fef1aecf2618e348b2af5729abf9'
         '12f7bdf5319f367cf64844848f6df38f'
         'fbf45a069a0c873df8573b28b43e75a4'
         '7beed57b30b552d382ff07d48859464b'
         '50b308a5654e9e310fb910a4441c80c0'
         '8a3cdd62d2137f0ca26e338fb457d139'
         '7a594300551b8b757a230a908ab3e95e'
         '152defee779691993145e14d8b180a3c'
         'b534d030d77ba317d9cee83206855e67'
         '314add763b0f5df3a23a10e1efd0ed0a'
         'edd9087e8aae92f77e117be67402e76e'
         '11361317818665e4fef3aa49863385ae'
         'e7ecf8bc797b0f277e7fac50ebd3f8aa'
         'dabe55a0f94c69ccad11336a79b38e5f'
         '5ea8e127b3813daaa924cb9495ddc0fc'
         '1ea3a9329a479d57a5c54abd4f21dd55'
         '6a117cb070717ba2be6e7a44d48aed38'
         '22ac08f5219f4a958ee687fb6e59828c'
         'b32b18e4b0f93972eefb1ea6761caac2'
         '3b5b69c0b81476d2b3583ac3bcde0e69'
         '1ce4eb889b13d14508903e33f59c323d'
         'e85aee157aa6ddd1af418a473f9f4e12'
         'd294003a37640b063b8e76dfe6ee9982'
         'b6aa69e9242ad9812264850c3c7e718b'
         'dc61362f7379fdf75053691212324a54'
         '4c9655db1aa85d95a3e534d1ab71af7b'
         'e8c936aa5ccdb8d192be27be63e98488'
         'b6631e3fd31bf9f6a6ae66ea974408ee'
         'de5eae176d6c4ea7a155731fcec503f1'
         '162882ff1543feaf27a19cf227653ebd'
         '8e9943395ddc5c1568b9267deab5a2b0'
         'd5b8efd26dc3a7c38d5e311e685ac006'
         '7be60dce3fa83b17249c030ab02dfc62'
         'c6c4798272ec7ccc8cbfd31dcb4f1a84'
         '4e5aa5c704211dda24d475d4d52a630b'
         '60b3861c84e14a17a161506089f0ed0d'
         'd75be90e1dda1b47fac01512c89f8c28')
